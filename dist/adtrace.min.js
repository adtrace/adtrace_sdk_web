!function(e){"use strict";function t(e,t,a,n,r){var o=new XMLHttpRequest;o.open(e,t,!0),o.setRequestHeader("Client-SDK","js1.1.2"),"POST"==e&&o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.onreadystatechange=function(){4===o.readyState&&(o.status>=200&&o.status<400?n&&n(o):r&&r&&r(new Error("Server responded with HTTP "+o.status),o))},o.send(a)}function a(e){var t=[];for(var a in e)e.hasOwnProperty(a)&&t.push(encodeURIComponent(a)+"="+encodeURIComponent(e[a]));return t.join("&")}function n(e){var t={};if("object"!=typeof e||!e)return t;for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a]);return t}!1 in new XMLHttpRequest&&(t=function(){}),e.AdTrace=function(e){e=e||{};var r,o={},s=localStorage.getItem("adtrace_js_sdk_id"),i=localStorage.getItem("adtrace_js_sdk_unique_id"),c=function(){var e=[],t=localStorage.getItem("adtrace_js_sdk_packages");if(null==t)return localStorage.setItem("adtrace_js_sdk_packages",""),e;for(var a=t.split("&"),n=0;n<a.length;n++)""!=a[n]&&e.push(a[n]);return e}(),_=.5,d=5,l=0,u=0,g=!1;return o.unique_id=e.unique_id,o.app_token=e.app_token,o.environment=e.environment,o.os_name=(r="unknown",-1!=navigator.platform.indexOf("Android")&&(r="android"),-1!=navigator.platform.indexOf("iPhone")&&(r="ios"),-1!=navigator.platform.indexOf("Win")&&(r="windows"),-1!=navigator.platform.indexOf("Mac")&&(r="mac-os"),-1!=navigator.platform.indexOf("X11")&&(r="unix"),-1!=navigator.platform.indexOf("Linux")&&(r="linux"),r),o.app_version="1.0.0",e.hasOwnProperty("default_tracker")&&(o.default_tracker=e.default_tracker),"android"==o.os_name?(o.gps_adid=o.unique_id,o.android_uuid=o.unique_id):"ios"==o.os_name?(o.idfa=o.unique_id,o.idfv=o.unique_id):o.win_adid=o.unique_id,o.unique_id!=i&&null!=s&&(localStorage.removeItem("adtrace_js_sdk_id"),localStorage.setItem("adtrace_js_sdk_packages",""),s=null),function e(){null==s?(r=function(t){var a=JSON.parse(t.responseText);a.hasOwnProperty("adid")?(s=a.adid,i=o.unique_id,localStorage.setItem("adtrace_js_sdk_id",s),localStorage.setItem("adtrace_js_sdk_unique_id",i),d=5,f()):(console.log("Adtrace SDK click will retry again in "+_*Math.pow(2,l)+" Sec."),console.log((new Date).getTime()),setTimeout(e,_*Math.pow(2,l)*1e3),l+=1)},c=function(t,a){console.log(t),console.log("Adtrace SDK click will retry again in "+_*Math.pow(2,l)+" Sec."),console.log((new Date).getTime()),setTimeout(e,_*Math.pow(2,l)*1e3),l+=1},(u=n(o)).device_type="phone",u.source="install_referrer",u.referrer="utm_source=google-play&utm_medium=organic",u.needs_response_details=1,u.event_buffering_enabled=0,u.raw_referrer=u.referrer,u.tracking_enabled=1,u.installed_at=(new Date).toISOString()+"+0000",u.session_count=1,u.attribution_deeplink=1,u.created_at=u.installed_at,u.sent_at=u.installed_at,t("POST","https://app.adtrace.io/sdk_click",a(u),r,c)):f();var r,c,u}(),{getAdId:function(){return s},trackSession:function(e,t){var r=n(o);r.created_at=(new Date).toISOString()+"+0000",r.sent_at=r.created_at,localStorage.setItem("adtrace_js_sdk_package_"+r.sent_at,"https://app.adtrace.io/session?"+a(r)),c.push(r.sent_at),localStorage.setItem("adtrace_js_sdk_packages",localStorage.getItem("adtrace_js_sdk_packages")+"&"+r.sent_at),f(e,t)},trackEvent:function(e,t,r){e=e||{};var s=n(o),i=function(e){var t=parseFloat(e.revenue);if(t<0||!e.currency)return null;return{revenue:t.toFixed(5),currency:e.currency}}(e),_=e.event_value,d=p(e.callback_params),l=p(e.partner_params);s.event_token=e.event_token,i&&(s.revenue=i.revenue,s.currency=i.currency);_&&(s.event_value=_);d&&(s.callback_params=JSON.stringify(d));l&&(s.partner_params=JSON.stringify(l));s.created_at=(new Date).toISOString()+"+0000",s.sent_at=s.created_at,localStorage.setItem("adtrace_js_sdk_package_"+s.sent_at,"https://app.adtrace.io/event?"+a(s)),c.push(s.sent_at),localStorage.setItem("adtrace_js_sdk_packages",localStorage.getItem("adtrace_js_sdk_packages")+"&"+s.sent_at),f(t,r)},stableData:function(){s&&localStorage.setItem("adtrace_js_sdk_id",s);i&&localStorage.setItem("adtrace_js_sdk_unique_id",i)}};function p(e){if(!(e=e||[]).length)return null;for(var t={},a=0;a<e.length;a++)t[e[a].key]=e[a].value;return n(t)}function f(e,a){g||c.length>0&&""!=c[0]&&(g=!0,t("GET",localStorage.getItem("adtrace_js_sdk_package_"+c[0]),null,function(t){var a=c.slice();a.shift(),localStorage.removeItem("adtrace_js_sdk_package_"+c[0]);for(var n="",r=0;r<a.length;r++)n+=a[r],r+1!=a.length&&(n+="&");localStorage.setItem("adtrace_js_sdk_packages",n),g=!1,d=5,(c=a).length>0&&f(),e&&e(t)},function(e,t){console.log(e),console.log("Adtrace SDK package will retry again in "+d*Math.pow(2,u)+" Sec."),setTimeout(f,d*Math.pow(2,u)*1e3),u+=1,g=!1,a&&a(e,t)}))}}}(window);