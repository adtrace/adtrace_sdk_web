!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=21)}([function(e,t,n){var r=n(2);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}e.exports=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r=n(12),o=n(13),i=n(7),a=n(14);e.exports=function(e,t){return r(e)||o(e,t)||i(e,t)||a()},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){(function(t,n){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */var r;r=function(){"use strict";function e(e){return"function"==typeof e}var r=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},o=0,i=void 0,a=void 0,u=function(e,t){v[o]=e,v[o+1]=t,2===(o+=2)&&(a?a(m):k())},s="undefined"!=typeof window?window:void 0,c=s||{},l=c.MutationObserver||c.WebKitMutationObserver,d="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),f="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function p(){var e=setTimeout;return function(){return e(m,1)}}var v=new Array(1e3);function m(){for(var e=0;e<o;e+=2)(0,v[e])(v[e+1]),v[e]=void 0,v[e+1]=void 0;o=0}var g,h,y,b,k=void 0;function w(e,t){var n=this,r=new this.constructor(P);void 0===r[x]&&B(r);var o=n._state;if(o){var i=arguments[o-1];u((function(){return N(o,r,i,n._result)}))}else I(n,r,e,t);return r}function S(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(P);return _(t,e),t}d?k=function(){return t.nextTick(m)}:l?(h=0,y=new l(m),b=document.createTextNode(""),y.observe(b,{characterData:!0}),k=function(){b.data=h=++h%2}):f?((g=new MessageChannel).port1.onmessage=m,k=function(){return g.port2.postMessage(0)}):k=void 0===s?function(){try{var e=Function("return this")().require("vertx");return void 0!==(i=e.runOnLoop||e.runOnContext)?function(){i(m)}:p()}catch(e){return p()}}():p();var x=Math.random().toString(36).substring(2);function P(){}function C(t,n,r){n.constructor===t.constructor&&r===w&&n.constructor.resolve===S?function(e,t){1===t._state?D(e,t._result):2===t._state?T(e,t._result):I(t,void 0,(function(t){return _(e,t)}),(function(t){return T(e,t)}))}(t,n):void 0===r?D(t,n):e(r)?function(e,t,n){u((function(e){var r=!1,o=function(e,t,n,r){try{e.call(t,n,r)}catch(e){return e}}(n,t,(function(n){r||(r=!0,t!==n?_(e,n):D(e,n))}),(function(t){r||(r=!0,T(e,t))}),e._label);!r&&o&&(r=!0,T(e,o))}),e)}(t,n,r):D(t,n)}function _(e,t){if(e===t)T(e,new TypeError("You cannot resolve a promise with itself"));else if(o=typeof(r=t),null===r||"object"!==o&&"function"!==o)D(e,t);else{var n=void 0;try{n=t.then}catch(t){return void T(e,t)}C(e,t,n)}var r,o}function E(e){e._onerror&&e._onerror(e._result),O(e)}function D(e,t){void 0===e._state&&(e._result=t,e._state=1,0!==e._subscribers.length&&u(O,e))}function T(e,t){void 0===e._state&&(e._state=2,e._result=t,u(E,e))}function I(e,t,n,r){var o=e._subscribers,i=o.length;e._onerror=null,o[i]=t,o[i+1]=n,o[i+2]=r,0===i&&e._state&&u(O,e)}function O(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,o=void 0,i=e._result,a=0;a<t.length;a+=3)r=t[a],o=t[a+n],r?N(n,r,o,i):o(i);e._subscribers.length=0}}function N(t,n,r,o){var i=e(r),a=void 0,u=void 0,s=!0;if(i){try{a=r(o)}catch(e){s=!1,u=e}if(n===a)return void T(n,new TypeError("A promises callback cannot return that same promise."))}else a=o;void 0!==n._state||(i&&s?_(n,a):!1===s?T(n,u):1===t?D(n,a):2===t&&T(n,a))}var A=0;function B(e){e[x]=A++,e._state=void 0,e._result=void 0,e._subscribers=[]}var R=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(P),this.promise[x]||B(this.promise),r(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?D(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&D(this.promise,this._result))):T(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;void 0===this._state&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===S){var o=void 0,i=void 0,a=!1;try{o=e.then}catch(e){a=!0,i=e}if(o===w&&void 0!==e._state)this._settledAt(e._state,t,e._result);else if("function"!=typeof o)this._remaining--,this._result[t]=e;else if(n===j){var u=new n(P);a?T(u,i):C(u,e,o),this._willSettleAt(u,t)}else this._willSettleAt(new n((function(t){return t(e)})),t)}else this._willSettleAt(r(e),t)},e.prototype._settledAt=function(e,t,n){var r=this.promise;void 0===r._state&&(this._remaining--,2===e?T(r,n):this._result[t]=n),0===this._remaining&&D(r,this._result)},e.prototype._willSettleAt=function(e,t){var n=this;I(e,void 0,(function(e){return n._settledAt(1,t,e)}),(function(e){return n._settledAt(2,t,e)}))},e}(),j=function(){function t(e){this[x]=A++,this._result=this._state=void 0,this._subscribers=[],P!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(e,t){try{t((function(t){_(e,t)}),(function(t){T(e,t)}))}catch(t){T(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var n=this.constructor;return e(t)?this.then((function(e){return n.resolve(t()).then((function(){return e}))}),(function(e){return n.resolve(t()).then((function(){throw e}))})):this.then(t,t)},t}();return j.prototype.then=w,j.all=function(e){return new R(this,e).promise},j.race=function(e){var t=this;return r(e)?new t((function(n,r){for(var o=e.length,i=0;i<o;i++)t.resolve(e[i]).then(n,r)})):new t((function(e,t){return t(new TypeError("You must pass an array to race."))}))},j.resolve=S,j.reject=function(e){var t=new this(P);return T(t,e),t},j._setScheduler=function(e){a=e},j._setAsap=function(e){u=e},j._asap=u,j.polyfill=function(){var e=void 0;if(void 0!==n)e=n;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=j},j.Promise=j,j},e.exports=r()}).call(this,n(16),n(17))},function(e,t,n){var r=n(18),o=n(19),i=n(7),a=n(20);e.exports=function(e){return r(e)||o(e)||i(e)||a()},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r=n(8);e.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r=n(15);e.exports=function(e,t){if(null==e)return{};var n,o,i=r(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){function n(t){return e.exports=n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,n(t)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){},function(e,t){e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,u=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){u=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(u)throw o}}return i}},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){var n,r,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function u(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var s,c=[],l=!1,d=-1;function f(){l&&s&&(l=!1,s.length?c=s.concat(c):d=-1,c.length&&p())}function p(){if(!l){var e=u(f);l=!0;for(var t=c.length;t;){for(s=c,c=[];++d<t;)s&&s[d].run();d=-1,t=c.length}s=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function v(e,t){this.fun=e,this.array=t}function m(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new v(e,t)),1!==c.length||l||u(p)},v.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var r=n(8);e.exports=function(e){if(Array.isArray(e))return r(e)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){"use strict";n.r(t);n(11);var r="adtrace-sdk-demo",o=r;function i(e,t){var n=localStorage.getItem("".concat(o,".").concat(e));return t?n:JSON.parse(n)}function a(e,t,n){t?localStorage.setItem("".concat(o,".").concat(e),n?t:JSON.stringify(t)):localStorage.removeItem("".concat(o,".").concat(e))}var u,s="\n---------------------- new ----------------------\n\n",c=null;function l(){c=document.getElementById("log"),function(){if(clearInterval(u),u=setInterval((function(){return d()}),2e3),!i("log",!0))return;c.textContent=[i("log",!0),s,c.textContent].join(""),c.scrollTop=c.scrollHeight}()}function d(){var e=c.innerText.split("\n");a("log",("\n"+e.slice(Math.max(e.length-3e3,1)).join("\n")).replace(new RegExp(s,"g"),""),!0)}function f(e){var t=(new Date).toISOString();c.textContent+=["[".concat(r,"]"),t,e].join(" ")+"\n",c.scrollTop=c.scrollHeight,d()}var p=n(2),v=n.n(p),m=n(1),g=n.n(m),h=n(0),y=n.n(h);var b=n(9),k=n.n(b),w=n(4),S=n.n(w),x={TRANSACTION_ERROR:"XHR transaction failed due to an error",SERVER_MALFORMED_RESPONSE:"Response from server is malformed",SERVER_INTERNAL_ERROR:"Internal error occurred on the server",SERVER_CANNOT_PROCESS:"Server was not able to process the request, probably due to error coming from the client",NO_CONNECTION:"No internet connectivity",SKIP:"Skipping slower attempt",MISSING_URL:"Url is not provided"},P="noStorage",C="indexedDB",_="localStorage",E=n(10),D=n.n(E);function T(e){return!Object.keys(e).length&&e.constructor===Object}function I(e){return"object"===D()(e)&&null!==e&&!(e instanceof Array)}function O(e){try{return I(JSON.parse(e))}catch(e){return!1}}function N(e,t,n){function r(e){return Array.isArray(t)?t.every((function(t){return e[t]===n[t]})):e[t]===n}for(var o=0;o<e.length;o+=1)if(r(e[o]))return o;return-1}function A(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.reduce((function(e,t){return y()(y()({},e),{},v()({},t.key,t.value))}),{})}function B(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.filter((function(e){return-1!==t.indexOf(e)}))}function R(e,t){return new RegExp("\\/".concat(t,"(\\/.*|\\?.*){0,1}$")).test(e)}function j(e,t){var n=g()(t,2),r=n[0],o=n[1];return y()(y()({},e),{},v()({},r,o))}function L(e){return Object.keys(e).map((function(t){return[t,e[t]]}))}function q(e){return Object.keys(e).map((function(t){return e[t]}))}function M(e){return I(e)?!T(e):!!e||0===e}var F,K={namespace:"adtrace-sdk",version:"2.0.7",env:"production"},U=(F={},v()(F,"none",-1),v()(F,"error",0),v()(F,"warning",1),v()(F,"info",2),v()(F,"verbose",3),F),G={log:"  ",info:" ",warn:" ",error:""},V={development:"verbose",production:"error",test:"verbose"},J=H(),W="";function H(){return V[K.env]||"error"}function Y(e,t){var n;if(!(U[J]<U[t])){for(var r=(new Date).toISOString(),o=G[e],i=["[".concat(K.namespace,"]"),r,"".concat(e.toUpperCase(),":").concat(o)],a=W?document.querySelector(W):null,u=arguments.length,s=new Array(u>2?u-2:0),c=2;c<u;c++)s[c-2]=arguments[c];(n=console)[e].apply(n,i.concat(s)),a&&(a.textContent+="".concat(i.join(" ")," ").concat(s.map((function(e){return I(e)?JSON.stringify(e):e})).join(" "),"\n"),a.scrollTop=a.scrollHeight)}}function z(e,t){return function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];Y.apply(void 0,[e,t].concat(r))}}var Q={setLogLevel:function(e,t){e&&-1===Object.keys(U).indexOf(e)?Y("error","error","You must set one of the available log levels: verbose, info, warning, error or none"):(J=e||H(),W=t||W,Y("info",e,"Log level set to ".concat(J)))},log:z("log","verbose"),info:z("info","info"),warn:z("warn","warning"),error:z("error","error")},X={},Z={},$=["appToken","environment"],ee=[].concat($,["defaultTracker","externalDeviceId"]),te=["urlStrategy","customUrl","eventDeduplicationListLimit","namespace"],ne={sessionWindow:18e5,sessionTimerWindow:6e4,requestValidityWindow:24192e5};function re(e){var t=$.filter((function(t){return!e[t]}));return!!t.length&&(Q.error("You must define ".concat(function(e){if(!e.length)return"";if(1===e.length)return"".concat(e[0]);var t=e.length-1,n=e.slice(0,t).join(", ");return"".concat(n," and ").concat(e[t])}(t))),!0)}var oe,ie,ae,ue,se,ce=y()(y()({},ne),{},{set:function(e){if(!re(e)){var t=[].concat(S()(ee),te).filter((function(t){return!!e[t]})).map((function(t){return[t,e[t]]}));X=t.filter((function(e){var t=g()(e,1)[0];return-1!==ee.indexOf(t)})).reduce(j,{}),Z=t.filter((function(e){var t=g()(e,1)[0];return-1!==te.indexOf(t)})).reduce(j,{})}},getBaseParams:function(){return y()({},X)},getCustomConfig:function(){return y()({},Z)},isInitialised:function(){return $.reduce((function(e,t){return e&&!!X[t]}),!0)},hasMissing:re,destroy:function(){X={},Z={}}});!function(e){e.Queue="queue",e.ActivityState="activityState",e.GlobalParams="globalParams",e.EventDeduplication="eventDeduplication"}(ie||(ie={})),function(e){e.Preferences="preferences"}(ae||(ae={})),function(e){e.Queue="q",e.ActivityState="as",e.GlobalParams="gp",e.EventDeduplication="ed"}(ue||(ue={})),function(e){e.Preferences="p"}(se||(se={}));var le={fields:{thirdPartySharingDisabled:{key:"td",keys:{reason:{key:"r",values:v()({},"general",1)},pending:{key:"p",values:{false:0,true:1}}}},sdkDisabled:{key:"sd",keys:{reason:{key:"r",values:(oe={},v()(oe,"general",1),v()(oe,"gdpr",2),oe)},pending:{key:"p",values:{false:0,true:1}}}}}};function de(e){return!!e&&Object.prototype.hasOwnProperty.call(e,"values")}function fe(e){return!!e&&Object.prototype.hasOwnProperty.call(e,"keys")}function pe(e){return!!e&&Object.prototype.hasOwnProperty.call(e,"composite")}function ve(e){return!!e&&"string"!=typeof e}var me={queue:{name:ue.Queue,scheme:{keyPath:"timestamp",autoIncrement:!1,fields:{url:{key:"u",values:{"/session":1,"/event":2,"/gdpr_forget_device":3,"/sdk_click":4,"/disable_third_party_sharing":5}},method:{key:"m",values:{GET:1,POST:2,PUT:3,DELETE:4}},timestamp:"t",createdAt:"ca",params:{key:"p",keys:{timeSpent:"ts",sessionLength:"sl",sessionCount:"sc",eventCount:"ec",lastInterval:"li",eventToken:"et",revenue:"re",currency:"cu",callbackParams:"cp",valueParams:"pp"}}}}},activityState:{name:ue.ActivityState,scheme:{keyPath:"uuid",autoIncrement:!1,fields:{uuid:{key:"u",values:{unknown:"-"}},timeSpent:"ts",sessionLength:"sl",sessionCount:"sc",eventCount:"ec",lastActive:"la",lastInterval:"li",installed:{key:"in",values:{false:0,true:1}},attribution:{key:"at",keys:{adid:"a",tracker_token:"tt",tracker_name:"tn",network:"nt",campaign:"cm",adgroup:"ag",creative:"cr",click_label:"cl",state:{key:"st",values:{installed:1,reattributed:2}}}}}}},globalParams:{name:ue.GlobalParams,scheme:{keyPath:"keyType",autoIncrement:!1,index:"type",fields:{keyType:{key:"kt",composite:["key","type"]},key:"k",value:"v",type:{key:"t",values:{callback:1,value:2}}}}},eventDeduplication:{name:ue.EventDeduplication,scheme:{keyPath:"internalId",autoIncrement:!0,fields:{internalId:"ii",id:"i"}}},preferences:{name:se.Preferences,scheme:le,permanent:!0}};function ge(e){try{return JSON.parse(e)}catch(t){return e}}function he(e,t,n){var r,o=de(n)?{values:(r=n.values,L(r).map((function(e){var t=g()(e,2),n=t[0];return[t[1],ge(n)]})).reduce(j,{}))}:{},i=fe(n)?{keys:ye(e,n.keys)}:{},a=pe(n)?{composite:n.composite.map((function(t){return be(e,t)}))}:{};return y()(y()(y()({key:t},o),i),a)}function ye(e,t){return L(t).map((function(t){var n=g()(t,2),r=n[0],o=n[1];return ve(o)?[o.key,he(e,r,o)]:[o,r]})).reduce(j,{})}function be(e,t){if(t){var n=me[e].scheme.fields[t];return ve(n)?n.key:n||t}}var ke,we,Se,xe=L(me).map((function(e){var t=g()(e,2),n=t[0],r=t[1];return[n,{keyPath:r.scheme.keyPath,autoIncrement:r.scheme.autoIncrement,index:r.scheme.index,fields:r.scheme.fields}]})).reduce(j,{}),Pe=L(xe).map((function(e){var t=g()(e,2),n=t[0],r=t[1];return[n,{keyPath:be(n,r.keyPath),autoIncrement:r.autoIncrement,index:be(n,r.index),fields:ye(n,r.fields)}]})).reduce(j,{}),Ce=L(me).reduce((function(e,t){var n=g()(t,2)[1];return e.concat(n.scheme.fields)}),[]).map((function(e){return q(e).filter(de).map((function(e){return L(e.values)})).reduce((function(e,t){return e.concat(t)}),[])})).reduce((function(e,t){return e.concat(t)}),[]).reduce(j,{}),_e=L(me).map((function(e){var t=g()(e,2),n=t[0],r=t[1];return[n,{name:r.name,permanent:r.permanent}]})).reduce(j,{}),Ee={left:xe,right:Pe,values:Ce,storeNames:{left:_e,right:(ke=_e,L(ke).map((function(e){var t=g()(e,2),n=t[0],r=t[1],o={name:n,permanent:r.permanent};return[r.name,o]})).reduce(j,{}))}};"undefined"==typeof Promise&&n(3).Promise;function De(e){return I(e)}function Te(e,t){return e&&void 0!==e[t]?e[t]:t}function Ie(e,t,n,r){if(n){var o=r||Ee[t][Be(e,Se.right)].fields;return L(n).map((function(n){var r=g()(n,2),i=r[0],a=r[1];return function(e,t,n,r,o){if(!o)return[n,r];var i=ve(o)?o.key:o;return De(r)?[i,Ie(e,t,r,fe(o)?o.keys:null)]:[i,Te(de(o)?o.values:null,r)]}(e,t,i,a,o[i])})).reduce((function(e,t){var n=g()(t,2),r=n[0],o=n[1];return y()(y()({},e),{},v()({},r,o))}),{})}}function Oe(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return n.map((function(n){return Ie(e,t,n)}))}function Ne(e,t,n){var r=Ee[t][Be(e,Se.right)],o=r.fields[r.keyPath],i=n instanceof Array?n.slice():[n],a=(pe(o)?o.composite:[r.keyPath]).map((function(e,t){var n=r.fields[e];return Te(de(n)?n.values:null,i[t])}));return 1===a.length?a[0]:a}function Ae(e){return Ee.values[e]||e}function Be(e,t){return(Ee.storeNames[t][e]||{}).name||e}function Re(e,t){return{name:t.name,message:t.message.replace('"'.concat(e,'"'),Be(e,Se.right))}}!function(e){e.LowerBound="lowerBound",e.UpperBound="upperBound"}(we||(we={})),function(e){e.right="right",e.left="left"}(Se||(Se={}));var je=n(5),Le=n.n(je),qe=n(6),Me=n.n(qe);function Fe(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=e+"",r=1;r<=t;r+=1)e<Math.pow(10,r)&&(n="0".concat(n));return n}function Ke(e){var t=e?new Date(e):new Date,n=function(e){var t=Fe(e.getDate()),n=Fe(e.getMonth()+1);return[e.getFullYear(),n,t].join("-")}(t),r=function(e){var t=Fe(e.getHours(),1),n=Fe(e.getMinutes()),r=Fe(e.getSeconds()),o=Fe(e.getMilliseconds(),2);return[t,n,r].join(":")+"."+o}(t),o=function(e){var t=e.getTimezoneOffset();return(t>0?"-":"+")+Fe(Math.floor(Math.abs(t)/60))+Fe(Math.abs(t)%60)}(t);return"".concat(n,"T").concat(r,"Z").concat(o)}function Ue(e,t){return isNaN(e)||isNaN(t)?0:Math.abs(t-e)}var Ge={},Ve=!1,Je=!1;function We(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Ge=Ve?y()({},e):{}}function He(){Ve&&(Ge.lastInterval=function(){var e=Ge.lastActive;if(e)return Math.round(Ue(e,Date.now())/1e3);return-1}(),Ge.lastActive=Date.now())}function Ye(e){Ge=y()(y()({},Ge),e)}function ze(){Je=!0}function Qe(){var e=Ge.lastActive;return Math.round(Ue(e,Date.now())/1e3)}function Xe(){return(Ge.timeSpent||0)+(Je?Qe():0)}function Ze(){var e=Ue(Ge.lastActive,Date.now())<ce.sessionWindow,t=Je||!Je&&e;return(Ge.sessionLength||0)+(t?Qe():0)}function $e(){Ve&&(Ye({timeSpent:Xe(),sessionLength:Ze()}),He())}var et={get current(){return Ve?y()({},Ge):{}},set current(e){We(e)},init:function(e){Ve=!0,We(e)},isStarted:function(){return Ve},toForeground:ze,toBackground:function(){Je=!1},initParams:function(){$e(),ze()},getParams:function(e){if(!Ve)return null;var t=Ge.lastInterval>=0?Ge.lastInterval:0,n={timeSpent:Ge.timeSpent||0,sessionLength:Ge.sessionLength||0,sessionCount:Ge.sessionCount||1,lastInterval:t||0};return e&&R(e,"event")&&(n.eventCount=Ge.eventCount),n},updateParams:function(e,t){if(Ve){var n={};n.timeSpent=Xe(),n.sessionLength=Ze(),R(e,"session")&&(n.sessionCount=(Ge.sessionCount||0)+1),R(e,"event")&&(n.eventCount=(Ge.eventCount||0)+1),Ye(n),t||He()}},updateInstalled:function(){Ve&&(Ge.installed||Ye({installed:!0}))},updateSessionOffset:$e,updateSessionLength:function(){Ve&&(Ye({sessionLength:Ze()}),He())},resetSessionOffset:function(){Ve&&Ye({timeSpent:0,sessionLength:0})},updateLastActive:He,destroy:function(){Ge={},Ve=!1,Je=!1}},tt={},nt=[];function rt(e,t){var n="id"+Math.random().toString(36).substr(2,16),r={id:n,cb:t};return tt[e]||(tt[e]=[]),tt[e].push(r),n}function ot(e,t){tt[e]&&tt[e].forEach((function(n){"function"==typeof n.cb&&nt.push(setTimeout((function(){return n.cb(e,t)})))}))}var it=new(function(){function e(){var t=this;Le()(this,e),v()(this,"defaultName",K.namespace),v()(this,"storageName",this.defaultName),v()(this,"storeNames",Ee.storeNames.left),v()(this,"storesMap",void 0),this.storesMap={};var n=this.read.bind(this),r=this.write.bind(this);q(this.storeNames).forEach((function(e){var o=e.name;Object.defineProperty(t.storesMap,o,{get:function(){return n(o)},set:function(e){r(o,e)}})})),Object.freeze(this.storesMap)}return Me()(e,[{key:"read",value:function(e){var t=localStorage.getItem("".concat(this.storageName,".").concat(e)),n=t?JSON.parse(t):null;return e===se.Preferences&&n?Ie(se.Preferences,Se.right,n):n}},{key:"write",value:function(e,t){t?localStorage.setItem("".concat(this.storageName,".").concat(e),JSON.stringify(t instanceof Array?t:Ie(se.Preferences,Se.left,t))):localStorage.removeItem("".concat(this.storageName,".").concat(e))}},{key:"clear",value:function(){this.deleteData()}},{key:"deleteData",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];q(this.storeNames).forEach((function(n){!t&&n.permanent||localStorage.removeItem("".concat(e.storageName,".").concat(n.name))}))}},{key:"setCustomName",value:function(e){var t=this;if(e&&e.length){var n="".concat(K.namespace,"-").concat(e);q(this.storeNames).forEach((function(e){var r=e.name,o=localStorage.getItem("".concat(t.storageName,".").concat(r));o&&localStorage.setItem("".concat(n,".").concat(r),o)})),this.deleteData(!0),this.storageName=n}}},{key:"stores",get:function(){return this.storesMap}}]),e}()),at=me.preferences.name,ut=st();function st(){return ut||ct(),ut?y()({},ut):null}function ct(){ut=it.stores[at]}function lt(){var e=st();return e?e.sdkDisabled:null}function dt(e){var t=e?y()({},e):null;it.stores[at]=y()(y()({},st()),{},{sdkDisabled:t}),ct()}function ft(){var e=st();return e?e.thirdPartySharingDisabled:null}function pt(){var e=it.stores[at]||{},t=(ut||{}).sdkDisabled||null;e.sdkDisabled&&!t&&ot("sdk:shutdown"),ct()}function vt(){it.stores[at]||(it.stores[at]=y()({},ut))}var mt,gt,ht="undefined"==typeof Promise?n(3).Promise:Promise;!function(e){e.add="add",e.put="put",e.get="get",e.list="list",e.clear="clear",e.delete="delete"}(mt||(mt={})),function(e){e.readonly="readonly",e.readwrite="readwrite"}(gt||(gt={}));var yt=function(){function e(){Le()(this,e),v()(this,"dbDefaultName",K.namespace),v()(this,"dbName",this.dbDefaultName),v()(this,"dbVersion",1),v()(this,"idbFactory",void 0),v()(this,"indexedDbConnection",null),v()(this,"notSupportedError",{name:"IDBNotSupported",message:"IndexedDB is not supported"}),v()(this,"databaseOpenError",{name:"CannotOpenDatabaseError",message:"Cannot open a database"}),v()(this,"noConnectionError",{name:"NoDatabaseConnection",message:"Cannot open a transaction"});var t=e.getIndexedDB();if(!t)throw this.notSupportedError;this.idbFactory=t}return Me()(e,[{key:"setCustomName",value:function(e){return e&&e.length>0?(this.dbName="".concat(K.namespace,"-").concat(e),this.migrateDb(this.dbDefaultName,this.dbName)):ht.resolve()}},{key:"openDatabase",value:function(t,n,r){var o=this;return e.isSupported().then((function(e){return e?new ht((function(e,i){var a=o.idbFactory.open(t,r);n&&(a.onupgradeneeded=function(e){return n(e,i)}),a.onsuccess=function(t){var n=t.target.result;n?e(n):i(o.databaseOpenError)},a.onerror=i})):ht.reject(o.notSupportedError)}))}},{key:"databaseExists",value:function(e){var t=this;return new ht((function(n){var r=!0;t.openDatabase(e,(function(){r=!1})).then((function(n){if(n.close(),!r)return t.deleteDatabaseByName(e)})).then((function(){return n(r)}))}))}},{key:"cloneData",value:function(e,t){var n=this;return q(Ee.storeNames.left).map((function(e){return e.name})).filter((function(e){return"p"!==e})).map((function(r){return function(){return o=r,i=n.indexedDbConnection,n.indexedDbConnection=e,n.getAll(o).then((function(e){if(n.indexedDbConnection=t,!(e.length<1))return n.addBulk(o,e,!0)})).then((function(){n.indexedDbConnection=i}));var o,i}})).reduce((function(e,t){return e.then(t)}),ht.resolve())}},{key:"migrateDb",value:function(e,t){var n=this;return this.databaseExists(e).then((function(r){return r?ht.all([n.openDatabase(e,n.handleUpgradeNeeded,n.dbVersion),n.openDatabase(t,n.handleUpgradeNeeded,n.dbVersion)]).then((function(t){var r=g()(t,2),o=r[0],i=r[1];return n.cloneData(o,i).then((function(){return n.indexedDbConnection=i,o.close(),n.deleteDatabaseByName(e)}))})).then((function(){return Q.info("Database migration finished")})):n.openDatabase(t,n.handleUpgradeNeeded,n.dbVersion).then((function(e){n.indexedDbConnection=e}))}))}},{key:"handleUpgradeNeeded",value:function(e,t){var n=e.target.result;e.target.transaction.onerror=t,e.target.transaction.onabort=t;var r=Ee.storeNames.left,o=et.current||{},i=o&&!T(o);L(r).filter((function(e){return!g()(e,2)[1].permanent})).forEach((function(e){var t=g()(e,2),r=t[0],a=t[1].name,u=Ee.right[r],s=n.createObjectStore(a,{keyPath:u.keyPath,autoIncrement:u.autoIncrement||!1});if(u.index&&s.createIndex("".concat(u.index,"Index"),u.index),a===ue.ActivityState&&i)return s.add(Ie(r,Se.left,o)),void Q.info("Activity state has been recovered");var c=it.stores[a];c&&(c.forEach((function(e){return s.add(e)})),Q.info("Migration from localStorage done for ".concat(r," store")))})),vt(),it.clear()}},{key:"open",value:function(){var e=this;return this.indexedDbConnection?ht.resolve({success:!0}):this.openDatabase(this.dbName,this.handleUpgradeNeeded,this.dbVersion).then((function(t){return e.indexedDbConnection=t,e.indexedDbConnection.onclose=function(){return e.destroy},{success:!0}}))}},{key:"getTransactionStore",value:function(e,t,n){var r,o=e.storeName,i=e.mode,a=n.transaction([o],i),u=a.objectStore(o),s=Ee.right[Be(o,Se.right)];return s.index&&(r=u.index("".concat(s.index,"Index"))),a.onerror=t,a.onabort=t,{transaction:a,store:u,index:r,options:s}}},{key:"overrideError",value:function(e,t){var n=t.target.error;return e({name:n.name,message:n.message})}},{key:"getCompositeKeys",value:function(e){var t=e.fields[e.keyPath];return pe(t)?t.composite:null}},{key:"targetIsObject",value:function(e){return I(e)}},{key:"prepareTarget",value:function(e,t,n){if(n===mt.clear||!t)return null;var r=this.getCompositeKeys(e);return-1!==[mt.add,mt.put].indexOf(n)?this.targetIsObject(t)?r?y()(v()({},e.keyPath,r.map((function(e){return t[e]})).join("")),t):t:null:t instanceof Array?t.join(""):t}},{key:"prepareResult",value:function(e,t){var n=this.getCompositeKeys(e);return n&&this.targetIsObject(t)?n.map((function(e){return t[e]})):null}},{key:"initRequest",value:function(e){var t=this,n=e.storeName,r=e.target,o=void 0===r?null:r,i=e.action,a=e.mode,u=void 0===a?gt.readonly:a;return this.open().then((function(){return new ht((function(e,r){if(t.indexedDbConnection){var a=t.getTransactionStore({storeName:n,mode:u},r,t.indexedDbConnection),s=a.store,c=a.options,l=s[i](t.prepareTarget(c,o,i)),d=t.prepareResult(c,o);l.onsuccess=function(){i!==mt.get||l.result?e(d||l.result||o):r({name:"NotRecordFoundError",message:'Requested record not found in "'.concat(n,'" store')})},l.onerror=function(e){return t.overrideError(r,e)}}else r(t.noConnectionError)}))}))}},{key:"initBulkRequest",value:function(e){var t=this,n=e.storeName,r=e.target,o=e.action,i=e.mode,a=void 0===i?gt.readwrite:i;return!r||r&&!r.length?ht.reject({name:"NoTargetDefined",message:"No array provided to perform ".concat(o,' bulk operation into "').concat(n,'" store')}):this.open().then((function(){return new ht((function(e,i){if(t.indexedDbConnection){var u=t.getTransactionStore({storeName:n,mode:a},i,t.indexedDbConnection),s=u.transaction,c=u.store,l=u.options,d=new Array,f=r[0];s.oncomplete=function(){return e(d)};!function e(n){n.onerror=function(e){return t.overrideError(i,e)},n.onsuccess=function(){d.push(t.prepareResult(l,f)||n.result),f=r[d.length],d.length<r.length&&e(c[o](t.prepareTarget(l,f,o)))}}(c[o](t.prepareTarget(l,f,o)))}else i(t.noConnectionError)}))}))}},{key:"openCursor",value:function(e){var t=this,n=e.storeName,r=e.action,o=e.range,i=void 0===o?null:o,a=e.firstOnly,u=void 0!==a&&a,s=e.mode,c=void 0===s?gt.readonly:s;return this.open().then((function(){return new ht((function(e,o){if(t.indexedDbConnection){var a=t.getTransactionStore({storeName:n,mode:c},o,t.indexedDbConnection),s=a.transaction,l=a.store,d=a.index,f=a.options,p=(d||l).openCursor(i),v=new Array;s.oncomplete=function(){return e(v)},p.onsuccess=function(e){var n=e.target.result;n&&(r===mt.delete?(n.delete(),v.push(t.prepareResult(f,n.value)||n.value[f.keyPath])):v.push(n.value),u||n.continue())},p.onerror=function(e){return t.overrideError(o,e)}}else o(t.noConnectionError)}))}))}},{key:"deleteDatabaseByName",value:function(e){var t=this;return new ht((function(n,r){var o=t.idbFactory.deleteDatabase(e);o.onerror=function(e){return t.overrideError(r,e)},o.onsuccess=function(){return n()},o.onblocked=function(e){return r(e.target)}}))}},{key:"getAll",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.openCursor({storeName:e,action:mt.list,firstOnly:t})}},{key:"getFirst",value:function(e){return this.getAll(e,!0).then((function(e){return e.length?e[0]:void 0}))}},{key:"getItem",value:function(e,t){return this.initRequest({storeName:e,target:t,action:mt.get})}},{key:"filterBy",value:function(e,t){var n=IDBKeyRange.only(t);return this.openCursor({storeName:e,action:mt.list,range:n})}},{key:"addItem",value:function(e,t){return this.initRequest({storeName:e,target:t,action:mt.add,mode:gt.readwrite})}},{key:"addBulk",value:function(e,t,n){return this.initBulkRequest({storeName:e,target:t,action:n?mt.put:mt.add,mode:gt.readwrite})}},{key:"updateItem",value:function(e,t){return this.initRequest({storeName:e,target:t,action:mt.put,mode:gt.readwrite})}},{key:"deleteItem",value:function(e,t){return this.initRequest({storeName:e,target:t,action:mt.delete,mode:gt.readwrite})}},{key:"deleteBulk",value:function(e,t,n){var r=n?IDBKeyRange[n](t):IDBKeyRange.only(t);return this.openCursor({storeName:e,action:mt.delete,range:r,mode:gt.readwrite})}},{key:"trimItems",value:function(e,t){var n=this,r=Ee.right[Be(e,Se.right)];return this.getAll(e).then((function(e){return e.length?e[t-1]:null})).then((function(t){return t?n.deleteBulk(e,t[r.keyPath],we.UpperBound):[]}))}},{key:"count",value:function(e){var t=this;return this.open().then((function(){return new ht((function(n,r){if(t.indexedDbConnection){var o=t.getTransactionStore({storeName:e,mode:gt.readonly},r,t.indexedDbConnection).store.count();o.onsuccess=function(){return n(o.result)},o.onerror=function(e){return t.overrideError(r,e)}}else r(t.noConnectionError)}))}))}},{key:"clear",value:function(e){return this.initRequest({storeName:e,action:mt.clear,mode:gt.readwrite})}},{key:"destroy",value:function(){this.indexedDbConnection&&this.indexedDbConnection.close(),this.indexedDbConnection=null}},{key:"deleteDatabase",value:function(){return this.destroy(),this.deleteDatabaseByName(this.dbName)}}],[{key:"tryOpen",value:function(t){return new ht((function(n){try{var r=t.open(e.dbValidationName);r.onsuccess=function(){r.result.close(),t.deleteDatabase(e.dbValidationName),n(!0)},r.onerror=function(){return n(!1)}}catch(e){n(!1)}}))}},{key:"isSupported",value:function(){return e.isSupportedPromise||(e.isSupportedPromise=new ht((function(t){var n=e.getIndexedDB(),r=!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform);!n||r?(Q.warn("IndexedDB is not supported in this browser"),t(!1)):t(e.tryOpen(n).then((function(e){return e||Q.warn("IndexedDB is not supported in this browser"),e})))}))),e.isSupportedPromise}},{key:"getIndexedDB",value:function(){return window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB}}]),e}();v()(yt,"dbValidationName","validate-db-openable"),v()(yt,"isSupportedPromise",null);var bt="undefined"==typeof Promise?n(3).Promise:Promise,kt=function(){function e(){Le()(this,e)}return Me()(e,[{key:"open",value:function(){return e.isSupported().then((function(e){if(!e)return{status:"error",error:{name:"LSNotSupported",message:"LocalStorage is not supported"}};var t=Ee.storeNames.left,n=et.current||{},r=n&&!T(n);return L(t).filter((function(e){return!g()(e,2)[1].permanent})).forEach((function(e){var t=g()(e,2),o=t[0],i=t[1].name;i!==ue.ActivityState||it.stores[i]?it.stores[i]||(it.stores[i]=[]):it.stores[i]=r?[Ie(o,Se.left,n)]:[]})),vt(),{status:"success"}}))}},{key:"getCompositeKeys",value:function(e){var t=e.fields[e.keyPath];return pe(t)?t.composite:null}},{key:"getKeys",value:function(e){var t=Be(e,Se.right),n=Ee.right[t];return this.getCompositeKeys(n)||[n.keyPath]}},{key:"nextIndex",value:function(e){return"number"==typeof e?e+1:void 0}},{key:"initRequest",value:function(e,t){var n=this,r=e.storeName,o=e.id,i=e.item,a=Ee.right[Be(r,Se.right)];return this.open().then((function(e){return"error"===e.status?bt.reject(e.error):new bt((function(e,u){var s,c=it.stores[r],l=n.getKeys(r),d=(c[c.length-1]||{})[a.keyPath]||0;if(o){var f=Array.isArray(o)?o.slice():[o];s=l.map((function(e,t){return[e,f[t]]})).reduce(j,{})}else s=y()({},i);var p=s?N(c,l,s):0;return t(e,u,{keys:l,items:c,index:p,options:a,lastId:d})}))}))}},{key:"sort",value:function(e,t,n){var r=S()(e),o=t.slice().reverse();return r.sort((function(e,t){return o.reduce((function(r,o){return r||function(e,t,r){var o=n?n===e[r]:e[r]<t[r],i=n?n>e[r]:e[r]>t[r];return o?-1:i?1:0}(e,t,o)}),0)}))}},{key:"prepareTarget",value:function(e,t,n){var r=this.getCompositeKeys(e);return r?y()(v()({},e.keyPath,r.map((function(e){return t[e]})).join("")),t):e.autoIncrement&&n?y()(v()({},e.keyPath,n),t):y()({},t)}},{key:"prepareResult",value:function(e,t){var n=this.getCompositeKeys(e);return n?n.map((function(e){return t[e]})).filter((function(e){return!De(e)})):t[e.keyPath]}},{key:"getAll",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.open().then((function(r){return"error"===r.status?bt.reject(r.error):new bt((function(r,o){var i=it.stores[e];i instanceof Array?r(n?[i[0]]:t.sort(i,t.getKeys(e))):o({name:"NotFoundError",message:"No objectStore named ".concat(e," in this database")})}))}))}},{key:"getFirst",value:function(e){return this.getAll(e,!0).then((function(e){return e.length?e[0]:void 0}))}},{key:"getItem",value:function(e,t){var n=this;return this.initRequest({storeName:e,id:t},(function(t,r,o){var i=o.items,a=o.index,u=o.options;-1===a?r({name:"NotRecordFoundError",message:'Requested record not found in "'.concat(e,'" store')}):t(n.prepareTarget(u,i[a]))}))}},{key:"filterBy",value:function(e,t){return this.getAll(e).then((function(n){return n.filter((function(n){var r=Ee.right[Be(e,Se.right)];return(r.index&&n[r.index])===t}))}))}},{key:"addItem",value:function(e,t){var n=this;return this.initRequest({storeName:e,item:t},(function(r,o,i){var a=i.items,u=i.index,s=i.options,c=i.lastId;-1!==u?o({name:"ConstraintError",message:'Constraint was not satisfied, trying to add existing item into "'.concat(e,'" store')}):(a.push(n.prepareTarget(s,t,n.nextIndex(c))),it.stores[e]=a,r(n.prepareResult(s,t)))}))}},{key:"addBulk",value:function(e,t,n){var r=this;return this.initRequest({storeName:e},(function(o,i,a){var u=a.keys,s=a.items,c=a.options,l=a.lastId;if(!t||t&&!t.length)i({name:"NoTargetDefined",message:'No array provided to perform add bulk operation into "'.concat(e,'" store')});else{var d=l,f=t.map((function(e){return r.prepareTarget(c,e,d=r.nextIndex(d))})),p=f.filter((function(e){return-1!==N(s,u,e)})).map((function(e){return e[c.keyPath]})),v=n?s.filter((function(e){return-1===p.indexOf(e[c.keyPath])})):S()(s);if(p.length&&!n)i({name:"ConstraintError",message:'Constraint was not satisfied, trying to add existing items into "'.concat(e,'" store')});else it.stores[e]=r.sort([].concat(S()(v),S()(f)),u),o(t.map((function(e){return r.prepareResult(c,e)})))}}))}},{key:"updateItem",value:function(e,t){var n=this;return this.initRequest({storeName:e,item:t},(function(r,o,i){var a=i.items,u=i.index,s=i.options,c=i.lastId,l=-1===u?n.nextIndex(c):void 0,d=n.prepareTarget(s,t,l);-1===u?a.push(d):a.splice(u,1,d),it.stores[e]=a,r(n.prepareResult(s,t))}))}},{key:"deleteItem",value:function(e,t){return this.initRequest({storeName:e,id:t},(function(n,r,o){var i=o.items,a=o.index;-1!==a&&(i.splice(a,1),it.stores[e]=i),n(t)}))}},{key:"findMax",value:function(e,t,n){if(!e.length)return-1;for(var r={index:-1,value:"string"==typeof n?"":0},o=0;o<e.length;o+=1){if(!(e[o][t]<=n))return r.index;e[o][t]>=r.value&&(r={value:e[o][t],index:o})}return r.index}},{key:"deleteBulk",value:function(e,t,n){var r=this;return this.getAll(e).then((function(o){var i=r.getKeys(e),a=Ee.right[Be(e,Se.right)].index||i[0],u=n?null:t,s=r.sort(o,i,u),c=r.findMax(s,a,t);if(-1===c)return[];var l=n===we.LowerBound?c:0,d=n&&n!==we.UpperBound?s.length:c+1,f=s.splice(l,d).map((function(e){return 1===i.length?e[a]:i.map((function(t){return e[t]}))}));return it.stores[e]=s,f}))}},{key:"trimItems",value:function(e,t){var n=this,r=Be(e,Se.right),o=Ee.right[r];return this.getAll(e).then((function(e){return e.length?e[t-1]:null})).then((function(t){return t?n.deleteBulk(e,t[o.keyPath],we.UpperBound):[]}))}},{key:"count",value:function(e){return this.open().then((function(t){if("error"===t.status)return bt.reject(t.error);var n=it.stores[e];return bt.resolve(n instanceof Array?n.length:1)}))}},{key:"clear",value:function(e){return this.open().then((function(t){return"error"===t.status?bt.reject(t.error):new bt((function(t){it.stores[e]=[],t()}))}))}},{key:"destroy",value:function(){}},{key:"deleteDatabase",value:function(){}}],[{key:"isSupported",value:function(){if(e.isSupportedPromise)return e.isSupportedPromise;var t=(new Date).toString(),n=window.localStorage;return e.isSupportedPromise=new bt((function(e){n.setItem(t,t);var r=n.getItem(t)===t;n.removeItem(t),e(!(!r||!n))})).catch((function(){return Q.warn("LocalStorage is not supported in this browser"),bt.resolve(!1)})),e.isSupportedPromise}}]),e}();v()(kt,"isSupportedPromise",null);var wt,St,xt="undefined"==typeof Promise?n(3).Promise:Promise;(St=wt||(wt={}))[St.noStorage=P]="noStorage",St[St.indexedDB=C]="indexedDB",St[St.localStorage=_]="localStorage";var Pt,Ct={getAll:function(e,t,n){return e.getAll(t,n).then((function(e){return Oe(t,Se.right,e)}))},getFirst:function(e,t){return e.getFirst(t).then((function(e){return Ie(t,Se.right,e)}))},getItem:function(e,t,n){return e.getItem(t,Ne(t,Se.left,n)).then((function(e){return Ie(t,Se.right,e)})).catch((function(e){return xt.reject(Re(t,e))}))},filterBy:function(e,t,n){return e.filterBy(t,Ae(n)).then((function(e){return Oe(t,Se.right,e)}))},addItem:function(e,t,n){var r=Ie(t,Se.left,n);return e.addItem(t,r).then((function(e){return Ne(t,Se.right,e)})).catch((function(e){return xt.reject(Re(t,e))}))},addBulk:function(e,t,n,r){var o=Oe(t,Se.left,n);return e.addBulk(t,o,r).then((function(e){return e.map((function(e){return Ne(t,Se.right,e)}))})).catch((function(e){return xt.reject(Re(t,e))}))},updateItem:function(e,t,n){var r=Ie(t,Se.left,n);return e.updateItem(t,r).then((function(e){return Ne(t,Se.right,e)}))},deleteItem:function(e,t,n){return e.deleteItem(t,Ne(t,Se.left,n)).then((function(e){return Ne(t,Se.right,e)}))},deleteBulk:function(e,t,n,r){return e.deleteBulk(t,Ae(n),r).then((function(e){return e.map((function(e){return Ne(t,Se.right,e)}))}))},trimItems:function(e,t,n){return e.trimItems(t,n)},count:function(e,t){return e.count(t)},clear:function(e,t){return e.clear(t)},destroy:function(e){return e.destroy()},deleteDatabase:function(e){return e.deleteDatabase()}};var _t=null;function Et(e){var t=null;return null!==_t?_t:_t=xt.all([yt.isSupported(),kt.isSupported()]).then((function(n){var r=g()(n,2),o=r[0],i=r[1];if(it.setCustomName(e),o){Pt=wt.indexedDB;var a=new yt;return a.setCustomName(e).then((function(){return t=a}))}return i?(Pt=wt.localStorage,t=new kt,xt.resolve(t)):(Q.error("There is no storage available, app will run with minimum set of features"),Pt=wt.noStorage,t=null,xt.resolve(t))})).then((function(){return{type:Pt,storage:t}}))}var Dt,Tt,It=y()({init:Et,getType:function(){return Pt}},L(Ct).map((function(e){var t=g()(e,2),n=t[0],r=t[1];return[n,function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return Et().then((function(t){var o=t.storage;if(o)return r.call.apply(r,[null,o,Be(e,Se.left)].concat(n))}))}]})).reduce(j,{}));"undefined"==typeof Promise&&n(3).Promise;function Ot(){return It.getAll("queue").then((function(e){return{queueSize:e.length}})).then((function(e){return y()(y()(y()(y()(y()(y()(y()(y()({},{createdAt:Ke()}),{sentAt:Ke()}),{webUuid:et.current.uuid}),(n=navigator,r=void 0!==n.doNotTrack,o=void 0!==window.doNotTrack,i=void 0!==n.msDoNotTrack,a=r?n.doNotTrack:o?window.doNotTrack:i?n.msDoNotTrack:null,0===parseInt(a,10)||"no"===a?{trackingEnabled:!0}:1===parseInt(a,10)||"yes"===a?{trackingEnabled:!1}:null)),{platform:"web"}),function(){var e=navigator,t=(e.language||e.userLanguage||"en").split("-"),n=g()(t,2),r=n[0],o=n[1];return{language:r,country:o?""+o.toLowerCase():void 0}}()),(t=navigator.userAgent||navigator.vendor,{machineType:"Win32"!==navigator.platform||-1===t.indexOf("WOW64")&&-1===t.indexOf("Win64")?navigator.platform:"Win64"})),e);var t,n,r,o,i,a}))}var Nt;"undefined"==typeof Promise&&n(3).Promise;function At(){var e=ce.getCustomConfig(),t=e.customUrl,n=e.urlStrategy;return t?{app:t,gdpr:t}:n===Nt.India?[Nt.India,Nt.Default]:n===Nt.China?[Nt.China,Nt.Default]:[Nt.Default,Nt.India,Nt.China]}!function(e){e.Default="default",e.India="india",e.China="china"}(Nt||(Nt={}));var Bt=(Dt={},v()(Dt,Nt.Default,{app:"https://app.adtrace.io",gdpr:"https://gdpr.adtrace.io"}),v()(Dt,Nt.India,{app:"https://app.adtrace.net.in",gdpr:"https://gdpr.adtrace.net.in"}),v()(Dt,Nt.China,{app:"https://app.adtrace.world",gdpr:"https://gdpr.adtrace.world"}),Dt),Rt=(Tt={},v()(Tt,Nt.Default,"default"),v()(Tt,Nt.India,"Indian"),v()(Tt,Nt.China,"Chinese"),Tt);var jt="undefined"==typeof Promise?n(3).Promise:Promise;function Lt(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{status:"error",action:n?"CONTINUE":"RETRY",response:O(e.responseText)?JSON.parse(e.responseText):e.responseText,message:x[t],code:t}}function qt(e,t){var n=e.slice(0,e.length-t.length-1).split("").reduce((function(e){return e.concat(" ")}),"");return"".concat(t).concat(n,":")}function Mt(e,t){var n=function(e){return e.replace(/([A-Z])/g,(function(e){return"_".concat(e.toLowerCase())}))},r=L(y()(y()(y()({},ce.getBaseParams()),t),e)).map((function(e){var t=g()(e,2),r=t[0],o=t[1];return[n(r),o]}));return Q.log("REQUEST PARAMETERS:"),r.filter((function(e){return M(g()(e,2)[1])})).map((function(e){var t=g()(e,2),n=t[0],r=t[1];return Q.log(qt("REQUEST PARAMETERS:",n),r),function(e){var t=g()(e,2),n=t[0],r=t[1],o=encodeURIComponent(n),i=r;return"string"==typeof r&&(i=encodeURIComponent(r)),I(r)&&(i=encodeURIComponent(JSON.stringify(r)||"")),[o,i].join("=")}([n,r])})).join("&")}function Ft(e,t,n){var r=n.xhr,o=n.url;if(4===r.readyState){var i=r.status>=200&&r.status<300,a=O(r.responseText);if(0!==r.status)return a?t(i?function(e,t){var n=JSON.parse(e.responseText),r={status:"success",adid:n.adid,timestamp:n.timestamp,ask_in:n.ask_in,retry_in:n.retry_in,continue_in:n.continue_in,tracking_state:n.tracking_state,attribution:void 0,message:void 0};return R(t,"attribution")&&(r.attribution=n.attribution,r.message=n.message),L(r).filter((function(e){return!!g()(e,2)[1]})).reduce(j,{})}(r,o):Lt(r,"SERVER_CANNOT_PROCESS",!0)):e(Lt(r,i?"SERVER_MALFORMED_RESPONSE":"SERVER_INTERNAL_ERROR"));e(Lt(r,"NO_CONNECTION"))}}function Kt(e,t,n){var r=e.url,o=e.method,i=void 0===o?"GET":o,a=e.params,u=function(e,t,n){var r=e.url,o=e.method,i=Mt(e.params,t);return{fullUrl:n["/gdpr_forget_device"===r?"gdpr":"app"]+r+("GET"===o?"?".concat(i):""),encodedParams:i}}({url:r,method:i,params:void 0===a?{}:a},t,n),s=u.fullUrl,c=u.encodedParams;return new jt((function(e,t){var n=new XMLHttpRequest;n.open(i,s,!0),function(e,t){var n=[["Client-SDK","js".concat(K.version)],["Content-Type","POST"===t?"application/x-www-form-urlencoded":"application/json"]];Q.log("REQUEST HEADERS:"),n.forEach((function(t){var n=g()(t,2),r=n[0],o=n[1];e.setRequestHeader(r,o),Q.log(qt("REQUEST HEADERS:",r),o)}))}(n,i),n.onreadystatechange=function(){return Ft(t,e,{xhr:n,url:r})},n.onerror=function(){return t(Lt(n,"TRANSACTION_ERROR"))},n.send("GET"===i?void 0:c)}))}function Ut(e,t){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Bt,n=At();if(Array.isArray(n)){var r=0,o=function o(){var i=n[r++],a=t[i];return e(a).catch((function(e){if("NO_CONNECTION"===e.code&&(Q.log("Failed to connect ".concat(Rt[i]," endpoint")),r<n.length))return Q.log("Trying ".concat(Rt[n[r]]," one")),o();throw e}))};return o()}return e(n)}((function(n){return Kt(e,t,n)}))}function Gt(e,t){return"success"===e.status?function(e,t){var n=R(t,"gdpr_forget_device"),r=R(t,"attribution"),o=R(t,"session"),i=R(t,"disable_third_party_sharing"),a="opted_out"===e.tracking_state;if(!n&&a)return ot("sdk:gdpr-forget-me"),e;r||n||a||!e.ask_in||ot("attribution:check",e);o&&ot("session:finished",e);if(i)return ot("sdk:third-party-sharing-opt-out"),e;return e}(e,t):e}function Vt(e){return Ot().then((function(t){return Ut(e,t)})).then((function(t){return Gt(t,e.url)}))}var Jt={long:{delay:12e4,maxDelay:864e5,minRange:.5,maxRange:1},short:{delay:200,maxDelay:36e5,minRange:.5,maxRange:1},test:{delay:100,maxDelay:300}};function Wt(e,t){var n,r,o=Jt[t=t||"long"],i=o.delay*Math.pow(2,e-1);return i=Math.min(i,o.maxDelay),o.minRange&&o.maxRange&&(i*=(n=o.minRange,r=o.maxRange,Math.random()*(r-n)+n)),Math.round(i)}var Ht=navigator.onLine;function Yt(){Ht=!0}function zt(){Ht=!1}function Qt(e,t,n){e.addEventListener&&e.addEventListener(t,n,!1)}function Xt(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}function Zt(){return Ht}var $t="undefined"==typeof Promise?n(3).Promise:Promise,en=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,n=e.method,r=void 0===n?"GET":n,o=e.params,i=void 0===o?{}:o,a=e.continueCb,u=e.strategy,s=e.wait,c={url:t,method:r,params:i,continueCb:a},l=t,d=r,f=y()({},i),p=a,v=u,m=null,h={request:0,connection:0},b=w(s),k=null;function w(e){return(e=e||150)>2147483647?2147483647:e}function S(e){var t=e.url,n=e.method,r=e.params,o=e.continueCb;t&&(l=t),n&&(d=n),T(r)||(f=y()({},r)),f=y()({createdAt:Ke()},f),"function"==typeof o&&(p=o)}function P(e){if(!k)return!1;if(m){var t=b-(Date.now()-k);if(e&&t<e)return!0;F()}return!1}function C(e){var t=e.wait,n=e.retrying;return b=t?w(t):b,P(t)?$t.resolve({status:"error",action:"CONTINUE",response:"",message:x.SKIP,code:"SKIP"}):l?(Q.log("".concat(n?"Re-trying":"Trying"," request ").concat(l," in ").concat(b,"ms")),k=Date.now(),_({url:l,method:d,params:y()({attempts:1},f)})):(Q.error("You must define url for the request to be sent"),$t.reject({status:"error",action:"CONTINUE",response:"",message:x.MISSING_URL,code:"MISSING_URL"}))}function _(e){return q(),Zt()?E(e):(h.connection+=1,Q.log("No internet connectivity, trying request ".concat(e.url," in ").concat(6e4,"ms")),new $t((function(t){m=setTimeout((function(){t(_(e))}),6e4)})))}function E(e){return new $t((function(t,n){m=setTimeout((function(){k=null;var r=L(e.params).filter((function(e){return M(g()(e,2)[1])})).reduce(j,{});return Vt({url:e.url,method:e.method,params:y()(y()({},r),{},{attempts:(h.request?h.request+1:1)+h.connection})}).then((function(e){return N(e,t)})).catch((function(e){return A(e,t,n)}))}),b)}))}function D(){l=c.url,d=c.method,f=y()({},c.params),p=c.continueCb}function I(e){Q.log("Request ".concat(l||"unknown"," ").concat(e?"failed":"has been finished")),h.request=0,h.connection=0,b=150,D(),F()}function O(e){return h.request+=1,F(),C({wait:e||Wt(h.request,v),retrying:!0})}function N(e,t){e&&e.retry_in?t(O(e.retry_in)):("function"==typeof p?p(e,I,O):I(),t(e))}function A(e,t,n){e&&"RETRY"===e.action?t(O("NO_CONNECTION"===e.code?6e4:void 0)):(I(!0),n(e||{}))}function B(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,n=e.method,r=e.params,o=void 0===r?{}:r,i=e.continueCb,a=e.wait;return S({url:t,method:n,params:o,continueCb:i}),C({wait:a})}function R(){return!!m}function q(){m&&clearTimeout(m),m=null}function F(){var e=!!k;q(),k=null,e&&(b=150,h.request=0,h.connection=0,Q.log("Previous ".concat(l||"unknown"," request attempt canceled")),D())}return{send:B,isRunning:R,clear:F}},tn=function(e){return"gdpr"===e?"GDPR disable":"disable"},nn=function(e){return{start:{inProgress:"Adtrace SDK ".concat(tn(e)," process has already started"),done:"Adtrace SDK ".concat(tn(e)," process is now started")},finish:{inProgress:"Adtrace SDK ".concat(tn(e)," process has already finished"),done:"Adtrace SDK ".concat(tn(e)," process is now finished")}}};function rn(e,t){var n=e.reason,r=e.pending,o=lt()||{},i="start"===t&&o.pending?"start":"finish",a="start"===t&&o.reason,u="finish"===t&&o.reason&&!o.pending;return a||u?(Q.log(nn(o.reason)[i].inProgress),!1):(Q.log(nn(n)[i].done),dt({reason:n||"general",pending:r}),!0)}function on(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return rn({reason:e,pending:t||!1},"start")}function an(){var e=lt()||{};return"general"===e.reason||"gdpr"===e.reason&&!e.pending?"off":"gdpr"===e.reason&&e.pending?"paused":"on"}var un="undefined"==typeof Promise?n(3).Promise:Promise,sn=!1;function cn(e){return e?"unknown"===e.uuid?(on({reason:"gdpr"}),et.destroy(),{exists:!0,stored:null}):(et.init(e),{exists:!0,stored:e}):{exists:!1}}function ln(){return"off"!==an()&&et.isStarted()}function dn(){if(!ln())return un.resolve(null);var e=y()(y()({},et.current),{},{lastActive:Date.now()});return It.updateItem("activityState",e).then((function(){return et.current=e}))}var fn="undefined"==typeof Promise?n(3).Promise:Promise,pn=en({strategy:"long",continueCb:function(e,t){var n=e&&e.continue_in||null;return mn.pause=n?{timestamp:Date.now(),wait:n}:null,It.getFirst("queue").then((function(e){return e?It.deleteItem("queue",e.timestamp):null})).then((function(){return t(),mn.running=!1,wn({wait:n})}))}}),vn=!1,mn={running:!1,timestamp:null,pause:null};function gn(){var e=Date.now();return mn.timestamp&&e<=mn.timestamp&&(e=mn.timestamp+1),mn.timestamp=e,e}function hn(e){return R(e,"session")&&et.resetSessionOffset(),et.updateLastActive(),dn()}function yn(e){var t=e.url,n=e.method,r=e.params,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=o.auto,a=o.timestamp;et.updateParams(t,i);var u=L(r||{}).filter((function(e){return M(g()(e,2)[1])})).reduce(j,{}),s={timestamp:gn(),url:t,method:n,params:y()(y()({},et.getParams(t)),u)};return a&&(s.createdAt=a),It.addItem("queue",s).then((function(){return hn(t)})).then((function(){return mn.running?{}:wn()}))}function bn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.timestamp,n=e.createdAt,r=e.url,o=e.method,i=e.params,a=arguments.length>1?arguments[1]:void 0,u=et.current||{},s="/session"===r&&!u.installed,c=!r&&!o&&!i;return vn&&!s||c?(mn.running=!1,fn.resolve({})):pn.send({url:r,method:o,params:y()(y()({},i),{},{createdAt:Ke(n||t)}),wait:a||kn()})}function kn(){var e=mn.pause||{},t=e.timestamp,n=e.wait,r=Date.now()-(t||0);return r<n?n-r:null}function wn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.cleanUp,n=e.wait;if(mn.running)return fn.resolve({});mn.running=!0;var r=fn.resolve({});return t&&(r=r.then(xn)),r.then((function(){return It.getFirst("queue")})).then((function(e){return bn(e,n)}))}function Sn(e){if(void 0!==e)if(e!==vn){var t=vn;vn=e,!e&&t&&wn(),Q.info("The app is now in ".concat(e?"offline":"online"," mode"))}else Q.error("The app is already in ".concat(e?"offline":"online"," mode"));else Q.error("State not provided, true or false has to be defined")}function xn(){var e=Date.now()-ce.requestValidityWindow;return It.deleteBulk("queue",e,"upperBound")}var Pn="undefined"==typeof Promise?n(3).Promise:Promise,Cn="No type provided",_n="Global parameter type not provided, `callback` or `value` types are available";function En(e){return(e||[]).map((function(e){return{key:e.key,value:e.value}}))}function Dn(){return Pn.all([It.filterBy("globalParams","callback"),It.filterBy("globalParams","value")]).then((function(e){var t=g()(e,2),n=t[0],r=t[1];return{callbackParams:En(n),eventValueParams:En(r)}}))}function Tn(e,t){if(void 0===t)return Q.error(_n),Pn.reject({message:Cn});var n=A(e),r=Object.keys(n).map((function(e){return{key:e,value:n[e],type:t}}));return Pn.all([It.filterBy("globalParams",t),It.addBulk("globalParams",r,!0)]).then((function(e){var n=g()(e,2),o=n[0],i=n[1],a=B(o.map((function(e){return e.key})),i.map((function(e){return e[0]})));return Q.log("Following ".concat(t," parameters have been saved: ").concat(r.map((function(e){return"".concat(e.key,":").concat(e.value)})).join(", "))),a.length&&Q.log("Keys: ".concat(a.join(", ")," already existed so their values have been updated")),i}))}function In(e,t){return void 0===t?(Q.error(_n),Pn.reject({message:Cn})):It.deleteItem("globalParams",[e,t]).then((function(n){return Q.log("".concat(e," ").concat(t," parameter has been deleted")),n}))}function On(e){return void 0===e?(Q.error(_n),Pn.reject({message:Cn})):It.deleteBulk("globalParams",e).then((function(t){return Q.log("All ".concat(e," parameters have been deleted")),t}))}var Nn,An,Bn,Rn="undefined"==typeof Promise?n(3).Promise:Promise,jn=!1,Ln=document;function qn(){return Bn=function(){var e=document;if(void 0!==e.hidden)return{hidden:"hidden",visibilityChange:"visibilitychange"};for(var t=L({mozHidden:"mozvisibilitychange",msHidden:"msvisibilitychange",oHidden:"ovisibilitychange",webkitHidden:"webkitvisibilitychange"}),n=0;n<t.length;n+=1){var r=g()(t[n],2),o=r[0],i=r[1];if(void 0!==e[o])return{hidden:o,visibilityChange:i}}return null}(),jn?Rn.reject({interrupted:!0,message:"Session watch already initiated"}):(jn=!0,rt("session:finished",Un),Bn&&Qt(Ln,Bn.visibilityChange,Kn),Bn&&Ln[Bn.hidden]?(Q.log("Session request attempt canceled because the tab is still hidden"),Rn.resolve({})):(et.initParams(),Vn()))}function Mn(){return Gn(),et.updateSessionOffset(),et.toBackground(),dn()}function Fn(){return It.getFirst("activityState").then((function(e){var t=et.current,n=t.lastActive||0;if(ln()&&n<e.lastActive){var r=!t.installed&&e.installed,o=(t.sessionCount||0)<(e.sessionCount||0);(r||o)&&ot("sdk:installed"),et.current=e,pt()}return e})).then((function(){et.updateSessionLength(),et.toForeground()})).then(Vn)}function Kn(){clearTimeout(An);var e=Bn&&Ln[Bn.hidden]?Mn:Fn;An=setTimeout(e,0)}function Un(e,t){if(!t||"error"!==t.status)return et.updateInstalled(),ot("sdk:installed"),dn();Q.error("Session was not successful, error was returned from the server:",t.response)}function Gn(){clearInterval(Nn)}function Vn(){Gn(),Nn=setInterval((function(){return et.updateSessionOffset(),dn()}),ce.sessionTimerWindow);var e=et.current,t=e.lastInterval,n=e.sessionCount>0;return!n||n&&1e3*t>=ce.sessionWindow?Dn().then((function(e){var t,n,r;yn({url:"/session",method:"POST",params:(t=e,n=t.callbackParams,r=t.eventValueParams,{callbackParams:n.length?A(n):null,valueParams:r.length?A(r):null})},{auto:!0})})):(ot("attribution:check"),dn())}var Jn="undefined"==typeof Promise?n(3).Promise:Promise,Wn=en({url:"/attribution",strategy:"short",continueCb:function(e,t,n){if(!e||e&&"error"===e.status)return t(),Jn.resolve({state:"unknown"});if(!e.ask_in)return t(),function(e){if(T(e)||!function(e){var t=e.adid,n=void 0===t?"":t,r=e.attribution,o=void 0===r?{}:r;return!!n&&!!B(Hn,Object.keys(o)).length}(e)||function(e){var t=e.adid,n=e.attribution,r=et.current.attribution||{};return!(n&&Hn.some((function(e){return r[e]!==n[e]})))&&t===r.adid}(e))return Jn.resolve({state:"same"});var t=L(e.attribution).filter((function(e){var t=g()(e,1)[0];return-1!==Hn.indexOf(t)})).reduce(j,{adid:e.adid});return et.current=y()(y()({},et.current),{},{attribution:t}),dn().then((function(){return ot("attribution:change",t),Q.info("Attribution has been updated"),{state:"changed"}}))}(e);return n(e.ask_in)}}),Hn=["tracker_token","tracker_name","network","campaign","adgroup","creative","click_label","state"];var Yn=en({url:"/gdpr_forget_device",method:"POST",strategy:"short"}),zn={running:"Adtrace SDK is running pending GDPR Forget Me request",pending:"Adtrace SDK will run GDPR Forget Me request after initialisation",paused:"Adtrace SDK is already prepared to send GDPR Forget Me request",off:"Adtrace SDK is already disabled"};function Qn(){return rn({reason:"gdpr",pending:!1},"finish")}function Xn(){var e,t;"paused"===an()&&(Q.log(zn.running),e=!0,t=an(),e||"on"===t?ce.isInitialised()?Yn.send({params:y()({},et.getParams())}).then((function(){ot("sdk:gdpr-forget-me")})):Q.log(zn.pending):Q.log(zn[t]))}var Zn={running:"Adtrace SDK is running pending third-party sharing opt-out request",delayed:"Adtrace SDK will run third-party sharing opt-out request after initialisation",pending:"Adtrace SDK already queued third-party sharing opt-out request",off:"Third-party sharing opt-out is already done",start:{inProgress:"Third-party sharing opt-out has already started",done:"Third-party sharing opt-out is now started"},finish:{inProgress:"Third-party sharing opt-out has already finished",done:"Third-party sharing opt-out is now finished"}};function $n(){var e=ft()||{};return e.reason?e.pending?"pending":"off":"on"}function er(e,t){var n,r,o=ft()||{},i="start"===t&&e?"start":"finish",a="start"===t&&o.reason,u="finish"===t&&o.reason&&!o.pending;return a||u?(Q.log(Zn[i].inProgress),!1):(Q.log(Zn[i].done),r=(n={reason:"general",pending:e})?y()({},n):null,it.stores[at]=y()(y()({},st()),{},{thirdPartySharingDisabled:r}),ct(),!0)}function tr(){return er(!1,"finish")}function nr(){var e,t;"pending"===$n()&&(Q.log(Zn.running),e=!0,t=$n(),e||"on"===t?ce.isInitialised()?yn({url:"/disable_third_party_sharing",method:"POST"}):Q.log(Zn.delayed):Q.log(Zn[t]))}var rr=[];function or(e,t){rr.push({method:e,description:t,timestamp:Date.now()})}var ir="undefined"==typeof Promise?n(3).Promise:Promise;function ar(e,t){var n,r,o=t.callbackParams,i=t.eventValueParams,a={},u=y()({eventToken:e.eventToken},(n=e.revenue,r=e.currency,isNaN(n)||(n=parseFloat(n))<0||!r?{}:{revenue:n.toFixed(5),currency:r})),s=y()(y()({},A(o)),A(e.callbackParams)),c=y()(y()({},A(i)),A(e.eventValueParams));return T(s)||(a.callbackParams=s),T(i)||(a.eventValueParams=c),y()(y()({},u),a)}function ur(e){return e?It.getAll("eventDeduplication").then((function(e){return e.map((function(e){return e.id}))})).then((function(t){return-1===t.indexOf(e)?function(e){var t=ce.getCustomConfig().eventDeduplicationListLimit,n=t>0?t:10;return It.count("eventDeduplication").then((function(e){var t=ir.resolve();if(e>=n){var r=e-n+1;Q.log("Event deduplication list limit has been reached. Oldest ids are about to be removed (".concat(r," of them)")),t=It.trimItems("eventDeduplication",r)}return t})).then((function(){return Q.info("New event deduplication id is added to the list: ".concat(e)),It.addItem("eventDeduplication",{id:e})}))}(e):ir.reject({message:"Event won't be tracked, since it was previously tracked with the same deduplication id ".concat(e)})})):ir.resolve()}function sr(e){return{clickTime:Ke(),source:"web_referrer",referrer:decodeURIComponent(e)}}function cr(){yn({url:"/sdk_click",method:"POST",params:sr(window.location.search.substring(1).split("&").map((function(e){return e.split("=")})).reduce(j,{}).adtrace_referrer)})}var lr=["logLevel","logOutput"],dr="undefined"==typeof Promise?n(3).Promise:Promise,fr=null,pr=!1,vr=!1,mr=!1;function gr(){var e;"paused"===an()&&(Qn(),dr.all([(e={uuid:"unknown"},et.current=e,It.clear("activityState").then((function(){return It.addItem("activityState",e)}))),It.clear("globalParams"),It.clear("queue")]).then(kr))}function hr(){return pr||ce.isInitialised()}function yr(){pr=!1,vr=!1,rr=[],pn.clear(),mn.running=!1,mn.timestamp=null,mn.pause=null,jn=!1,et.toBackground(),Gn(),Bn&&(clearTimeout(An),Xt(Ln,Bn.visibilityChange,Kn)),Wn.clear()}function br(e){e&&Q.log("Adtrace SDK has been shutdown due to asynchronous disable"),yr(),nt.forEach(clearTimeout),nt=[],tt={},et.destroy(),Xt(window,"online",Yt),Xt(window,"offline",zt),It.destroy(),ce.destroy()}function kr(){mr=!1,br(),Yn.clear(),fr=null,Q.log("Adtrace SDK instance has been destroyed")}function wr(e){Q.log("Adtrace SDK is starting with web_uuid set to ".concat(e.uuid));var t=et.current.installed;Xn(),t||nr();var n=an(),r=function(e){return"Adtrace SDK start has been interrupted ".concat(e)};return"off"===n?(br(),dr.reject({interrupted:!0,message:r("due to complete async disable")})):"paused"===n?(yr(),dr.reject({interrupted:!0,message:r("due to partial async disable")})):vr?dr.reject({interrupted:!0,message:r("due to multiple synchronous start attempt")}):(wn({cleanUp:!0}),qn().then((function(){pr=!1,vr=!0,t&&(Sr(),nr())})))}function Sr(){var e;mr=!0,rr.forEach((function(e){"function"==typeof e.method&&(Q.log("Delayed ".concat(e.description," task is running now")),e.method(e.timestamp))})),rr=[],(e="sdk:installed")&&L(tt).some((function(t){var n=g()(t,2)[1];return n.some((function(t,r){if(t.id===e)return n.splice(r,1),!0}))}))}function xr(e){if(e.interrupted)Q.log(e.message);else if(br(),Q.error("Adtrace SDK start has been canceled due to an error",e),e.stack)throw e}function Pr(e){"off"!==an()?(ce.set(e),Qt(window,"online",Yt),Qt(window,"offline",zt),rt("sdk:installed",Sr),rt("sdk:shutdown",(function(){return br(!0)})),rt("sdk:gdpr-forget-me",gr),rt("sdk:third-party-sharing-opt-out",tr),rt("attribution:check",(function(e,t){return n=t,r=et.current,(o=(n||{}).ask_in)||!r.attribution&&r.installed?(Wn.send({params:y()({initiatedBy:n?"backend":"sdk"},et.getParams()),wait:o}),et.updateSessionOffset(),dn()):Jn.resolve(r);var n,r,o})),"function"==typeof e.attributionCallback&&rt("attribution:change",e.attributionCallback),(sn?un.reject({interrupted:!0,message:"Adtrace SDK start already in progress"}):(sn=!0,It.getFirst("activityState").then(cn).then((function(e){if(e.exists)return sn=!1,e.stored;var t,n=T(et.current)?{uuid:(t=Date.now(),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"===e?n:11&n).toString(16)})))}:et.current;return It.addItem("activityState",n).then((function(){return et.init(n),pt(),sn=!1,n}))})))).then(wr).then(cr).catch(xr)):Q.log("Adtrace SDK is disabled, can not start the sdk")}function Cr(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.schedule,o=n.stopBeforeInit;It.getType()!==P?"on"===an()?r&&o&&!hr()?Q.error("Adtrace SDK can not ".concat(e,", sdk instance is not initialized")):"function"==typeof t&&(!r||mr&&vr||!o&&!hr()?t():(or(t,e),Q.log("Running ".concat(e," is delayed until Adtrace SDK is up")))):Q.log("Adtrace SDK is disabled, can not ".concat(e)):Q.log("Adtrace SDK can not ".concat(e,", no storage available"))}var _r={initSdk:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.logLevel,n=e.logOutput,r=k()(e,lr);Q.setLogLevel(t,n),hr()?Q.error("You already initiated your instance"):ce.hasMissing(r)||(pr=!0,It.init(r.namespace).then((function(e){e.type!==P?(Q.info("Available storage is ".concat(e.type)),fr=y()({},r),Pr(r)):Q.error("Adtrace SDK can not start, there is no storage available")})))},trackEvent:function(e){Cr("track event",(function(t){return function(e,t){if(e&&(!e||!T(e)&&e.eventToken))return ur(e.deduplicationId).then(Dn).then((function(n){yn({url:"/event",method:"POST",params:ar(e,n)},{timestamp:t})})).catch((function(e){e&&e.message&&Q.error(e.message)}));Q.error("You must provide event token in order to track event")}(e,t)}),{schedule:!0,stopBeforeInit:!0})},addGlobalCallbackParameters:function(e){Cr("add global callback parameters",(function(){return Tn(e,"callback")}))},addGlobalValueParameters:function(e){Cr("add global value parameters",(function(){return Tn(e,"value")}))},removeGlobalCallbackParameter:function(e){Cr("remove global callback parameter",(function(){return In(e,"callback")}))},removeGlobalValueParameter:function(e){Cr("remove global value parameter",(function(){return In(e,"value")}))},clearGlobalCallbackParameters:function(){Cr("remove all global callback parameters",(function(){return On("callback")}))},clearGlobalValueParameters:function(){Cr("remove all global value parameters",(function(){return On("value")}))},switchToOfflineMode:function(){Cr("set offline mode",(function(){return Sn(!0)}))},switchBackToOnlineMode:function(){Cr("set online mode",(function(){return Sn(!1)}))},stop:function(){on()&&ce.isInitialised()&&br()},restart:function(){var e;("gdpr"===(e=lt()||{}).reason?(Q.log("Adtrace SDK is disabled due to GDPR-Forget-Me request and it can not be re-enabled"),!1):e.reason?(Q.log("Adtrace SDK has been enabled"),dt(null),!0):(Q.log("Adtrace SDK is already enabled"),!1))&&fr&&Pr(fr)},session:function(){var e=et.current.installed;qn().then((function(){pr=!1,vr=!0,e&&(Sr(),nr())}))},gdprForgetMe:function(){},disableThirdPartySharing:function(){},initSmartBanner:function(){},__testonly__:{destroy:kr,clearDatabase:function(){return It.deleteDatabase()}}},Er={},Dr={},Tr={},Ir=!1,Or={},Nr=null;function Ar(e){var t=e.target.id.replace(/(-\w)/g,(function(e){return g()(e,2)[1].toUpperCase()})),n=Er[t],r=Er[t+"Container"];n.id!==Tr.tab.id&&(n.classList.add("active"),r.classList.add("active"),Tr.tab.classList.remove("active"),Tr.container.classList.remove("active"),Tr.tab=n,Tr.container=r)}function Br(e){if(e.preventDefault(),!Ir){Ir=!0,Er.submitButton.classList.add("loading"),Er.submitButton.disabled=!0;var t=Object.keys(Dr).map((function(e){return[e,Dr[e].value]})).filter((function(e){return g()(e,2)[1]})).reduce((function(e,t){var n=g()(t,2),r=n[0],o=n[1];return y()(y()({},e),{},v()({},r,o))}),{});Lr(t),a("appConfig",t),clearTimeout(Nr),Nr=setTimeout((function(){Ir=!1,Er.submitButton.classList.remove("loading"),Er.submitButton.disabled=!1,Ar({target:{id:"log-tab"}}),_r.__testonly__.destroy(),_r.initSdk(y()(y()({},t),{},{attributionCallback:jr}))}))}}function Rr(){if(!Ir){Ir=!0,Er.resetButton.classList.add("loading"),Er.resetButton.disabled=!0;var e=y()({},Or);Lr(e),localStorage.clear(),_r.__testonly__.clearDatabase().catch((function(e){throw f("There was an error while attempting to delete the storage, please refresh"),e})).then((function(){a("appConfig",e),f("The storage is deleted and the sdk is re-initiated"),setTimeout((function(){window.location.reload()}))}))}}function jr(e,t){f("NEW ATTRIBUTION"),f(JSON.stringify(t,void 0,2))}function Lr(e){Er.appConfigJson.textContent="Adtrace.initSdk(".concat(JSON.stringify(e,void 0,2),")")}var qr=function(e){var t;Or=y()({},e),Er.logTab=document.getElementById("log-tab"),Er.logTabContainer=document.getElementById("log-tab-container"),Er.appConfigTab=document.getElementById("app-config-tab"),Er.appConfigTabContainer=document.getElementById("app-config-tab-container"),Er.appConfigForm=document.getElementById("app-config-form"),Er.appConfigJson=document.getElementById("app-config-json"),Er.submitButton=Er.appConfigForm.querySelector('button[type="submit"]'),Er.resetButton=Er.appConfigForm.querySelector("#reset"),t=i("appConfig")||y()({},Or),_r.initSdk(y()(y()({},t),{},{attributionCallback:jr})),_r.initSmartBanner({webToken:"77170eewyww0",logLevel:"verbose"}),Dr.appToken=Er.appConfigForm.querySelector("#app-token"),Dr.environment=Er.appConfigForm.querySelector("#environment"),Dr.defaultTracker=Er.appConfigForm.querySelector("#default-tracker"),Dr.customUrl=Er.appConfigForm.querySelector("#custom-url"),Dr.logLevel=Er.appConfigForm.querySelector("#log-level"),Dr.logOutput=Er.appConfigForm.querySelector("#log-output"),Dr.eventDeduplicationListLimit=Er.appConfigForm.querySelector("#event-deduplication-list-limit"),Dr.externalDeviceId=Er.appConfigForm.querySelector("#external-device-id"),Object.keys(Dr).map((function(e){return Dr[e].value=t[e]||""})),Lr(t),Tr.tab=Er.logTab,Tr.container=Er.logTabContainer,Er.logTab.addEventListener("click",Ar,!1),Er.appConfigTab.addEventListener("click",Ar,!1),Er.appConfigForm.addEventListener("submit",Br,!1),Er.resetButton.addEventListener("click",Rr,!1)},Mr={add:"+",remove:"×"};function Fr(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=document.createElement(e);return(t=i.classList).add.apply(t,S()(n)),r&&i.appendChild(document.createTextNode(r)),Object.keys(o).map((function(e){return[e,o[e]]})).map((function(e){var t=g()(e,2),n=t[0],r=t[1];return i[n]=r})),i}function Kr(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=Fr("div",["form-row","flex-one","flex-box-row"]),o=Fr("label",["flex-auto"],t),i=Fr("input",["flex-one",e],null,{type:"text",value:n});return r.appendChild(o),r.appendChild(i),r}function Ur(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=Fr("div",["flex-box-row","form-row-group"]),i=Kr("key-input","Key",r.key),a=Kr("value-input","Value",r.value),u=n?"add":"remove",s=Fr("button",["flex-auto",u],Mr[u],{type:"button"});s.addEventListener("click",t,!1),o.appendChild(i),o.appendChild(a),o.appendChild(s),e.appendChild(o)}var Gr=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=e,o=t,i=null;function a(){i=document.getElementById(r),o.length?o.forEach((function(e,n){var r=n===t.length-1;Ur(i,r?l:c,r,e)})):Ur(i,l,!0)}function u(){var e=i.querySelectorAll(".form-row-group");return Array.from(e).map((function(e){var t=e.querySelector(".".concat("key-input")).value,n=e.querySelector(".".concat("value-input")).value;return t&&n?{key:t,value:n}:null})).filter((function(e){return!!e}))}function s(){Array.from(i.querySelectorAll(".form-row-group")).map((function(e){var t=e.querySelector("button"),n=t.classList.contains("add")?l:c;t.removeEventListener("click",n,!1),e.remove()})),Ur(i,l,!0)}function c(e){var t=e.target;t.removeEventListener("click",c,!1),t.parentNode.remove(),"function"==typeof n&&n()}function l(e){var t=e.target.parentNode,r=t.querySelector(".".concat("key-input")).value,o=t.querySelector(".".concat("value-input")).value;r&&o&&(Ur(i,l,!0),d(t),"function"==typeof n&&n())}function d(e){var t=Fr("button",["flex-auto","remove"],Mr.remove,{type:"button"}),n=e.querySelector(".add");t.addEventListener("click",c,!1),n.removeEventListener("click",l,!1),n.remove(),e.appendChild(t)}return{init:a,query:u,reset:s}},Vr={},Jr={},Wr={},Hr=!1,Yr=null,zr=null,Qr=null;function Xr(e){if(e.preventDefault(),!Hr){Hr=!0,Vr.submitButton.classList.add("loading"),Vr.submitButton.disabled=!0;var t=zr.query(),n=Qr.query(),r={};t.length&&(r.callbackParams=t),n.length&&(r.eventValueParams=n);var o=Object.keys(Jr).map((function(e){return[e,Jr[e].value]})).filter((function(e){return g()(e,2)[1]})).reduce((function(e,t){var n=g()(t,2),r=n[0],o=n[1];return y()(y()({},e),{},v()({},r,o))}),r);to(o),a("eventConfig",o),clearTimeout(Yr),Yr=setTimeout((function(){Hr=!1,Vr.submitButton.classList.remove("loading"),Vr.submitButton.disabled=!1,_r.trackEvent(o)}),1e3)}}function Zr(){var e=i("eventConfig")||y()({},Wr);Hr||(Hr=!0,Vr.trackEventButton.classList.add("loading"),Vr.trackEventButton.disabled=!0,clearTimeout(Yr),Yr=setTimeout((function(){Hr=!1,Vr.trackEventButton.classList.remove("loading"),Vr.trackEventButton.disabled=!1,_r.trackEvent(e)}),1e3))}function $r(e){var t=e.target;t.parentNode.nextElementSibling.classList.toggle("show"),t.classList.toggle("active")}function eo(){var e=i("eventConfig")||y()({},Wr);Jr.eventToken=Vr.eventConfigForm.querySelector("#event-token"),Jr.revenue=Vr.eventConfigForm.querySelector("#revenue"),Jr.currency=Vr.eventConfigForm.querySelector("#currency"),Jr.deduplicationId=Vr.eventConfigForm.querySelector("#deduplication-id"),zr=Gr("event-callback-params",e.callbackParams),Qr=Gr("event-value-params",e.valueParams),zr.init(),Qr.init(),Object.keys(Jr).map((function(t){return Jr[t].value=e[t]||""})),to(e)}function to(e){Vr.eventConfigJson.textContent="Adtrace.trackEvent(".concat(JSON.stringify(e,void 0,2),")")}var no=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Wr=y()({},e),Vr.eventConfigForm=document.getElementById("event-config-form"),Vr.eventConfigJson=document.getElementById("event-config-json"),Vr.trackEventButton=document.getElementById("track-event-button"),Vr.toggleButton=document.getElementById("event-side-form-toggle"),Vr.submitButton=Vr.eventConfigForm.querySelector('button[type="submit"]'),eo(),Vr.eventConfigForm.addEventListener("submit",Xr,!1),Vr.toggleButton.addEventListener("click",$r,!1),Vr.trackEventButton.addEventListener("click",Zr,!1)},ro=function(e,t){var n=e,r=t,o=null,i={},a=!1,u=null,s=null;function c(e){e.preventDefault();var t=s.query();!a&&t.length&&(a=!0,i.submitButton.classList.add("loading"),i.submitButton.disabled=!0,clearTimeout(u),u=setTimeout((function(){a=!1,i.submitButton.classList.remove("loading"),i.submitButton.disabled=!1,_r[r](t),l(),s.reset(),d()}),1e3))}function l(){i.actionButton.nextElementSibling.classList.toggle("show"),i.actionButton.classList.toggle("active")}function d(){i.json.textContent="Adtrace.".concat(r,"(").concat(JSON.stringify(s.query(),void 0,2),")")}return function(){o=document.getElementById(n),i.actionButton=o.querySelector('button[type="button"]'),i.submitButton=o.querySelector('button[type="submit"]'),i.form=o.querySelector("form"),i.json=o.querySelector("pre.config"),i.actionButton.addEventListener("click",l,!1),i.form.addEventListener("submit",c,!1),(s=Gr("".concat(n,"-params"),[],d)).init()}};var oo=function(){ro("addgcp","addGlobalCallbackParameters")()};var io=function(){ro("addgpp","addGlobalValueParameters")()},ao=function(e,t){var n=e,r=t,o=null,i={},a=!1,u=null;function s(e){e.preventDefault();var t=i.input.value;!a&&t&&(a=!0,i.submitButton.classList.add("loading"),i.submitButton.disabled=!0,clearTimeout(u),u=setTimeout((function(){a=!1,i.submitButton.classList.remove("loading"),i.submitButton.disabled=!1,_r[r](t),c(),i.input.value="",l()}),1e3))}function c(){i.actionButton.nextElementSibling.classList.toggle("show"),i.actionButton.classList.toggle("active")}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{target:{value:""}};i.json.textContent="Adtrace.".concat(r,"(").concat(e.target.value,")")}return function(){o=document.getElementById(n),i.actionButton=o.querySelector('button[type="button"]'),i.submitButton=o.querySelector('button[type="submit"]'),i.input=o.querySelector('input[type="text"]'),i.form=o.querySelector("form"),i.json=o.querySelector("pre.config"),i.actionButton.addEventListener("click",c,!1),i.input.addEventListener("keydown",function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;return function(){var r=arguments,o=this;clearTimeout(t),t=setTimeout((function(){return e.apply(o,r)}),n)}}(l,200),!1),i.form.addEventListener("submit",s,!1)}};var uo=function(){ao("removegcp","removeGlobalCallbackParameter")()};var so=function(){ao("removegpp","removeGlobalValueParameter")()},co=function(e,t){var n=e,r=t,o=null,i={},a=!1,u=null;function s(){a||(a=!0,i.actionButton.classList.add("loading"),i.actionButton.disabled=!0,clearTimeout(u),u=setTimeout((function(){a=!1,i.actionButton.classList.remove("loading"),i.actionButton.disabled=!1,r()}),1e3))}function c(){i.toggleButton.parentNode.nextElementSibling.classList.toggle("show"),i.toggleButton.classList.toggle("active")}return function(){o=document.getElementById(n),i.actionButton=o.querySelector('button[type="button"].action'),i.toggleButton=o.querySelector('button[type="button"].toggle'),i.actionButton.addEventListener("click",s,!1),i.toggleButton.addEventListener("click",c,!1)}};var lo=function(){co("cleargcp",_r.clearGlobalCallbackParameters)()};var fo=function(){co("cleargpp",_r.clearGlobalValueParameters)()};var po=function(){co("gooffline",_r.switchToOfflineMode)()};var vo=function(){co("goonline",_r.switchBackToOnlineMode)()};var mo=function(){co("stop",_r.stop)()};var go=function(){co("restart",_r.restart)()};var ho=function(){co("session",_r.session)()};var yo=function(){co("gdpr",_r.gdprForgetMe)()};var bo=function(){co("dtps",_r.disableThirdPartySharing)()};var ko=function(e,t){l(),qr(e),no(t),oo(),io(),uo(),so(),lo(),fo(),po(),vo(),mo(),go(),ho(),yo(),bo()},wo={appToken:"anykmem88j9x",environment:"production",logLevel:"verbose",logOutput:"#log"},So={eventToken:"m91e4d"};window.addEventListener("DOMContentLoaded",(function(){ko(wo,So)}))}]);