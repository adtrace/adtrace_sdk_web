!function(e){"use strict";function t(e,t,a,n,r){var o=new XMLHttpRequest;o.open(e,t,!0),o.setRequestHeader("Client-SDK","js1.1.4"),"POST"==e&&o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.onreadystatechange=function(){4===o.readyState&&(o.status>=200&&o.status<400?n&&n(o):r&&r&&r(new Error("Server responded with HTTP "+o.status),o))},o.send(a)}function a(e){var t=[];for(var a in e)e.hasOwnProperty(a)&&t.push(encodeURIComponent(a)+"="+encodeURIComponent(e[a]));return t.join("&")}function n(e){var t={};if("object"!=typeof e||!e)return t;for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a]);return t}!1 in new XMLHttpRequest&&(t=function(){}),e.AdTrace=function(r){r=r||{};var o,s,c,i={},l=localStorage.getItem("adtrace_js_sdk_id"),d=localStorage.getItem("adtrace_js_sdk_unique_id"),_=function(){var e=[],t=localStorage.getItem("adtrace_js_sdk_packages");if(null==t)return localStorage.setItem("adtrace_js_sdk_packages",""),e;for(var a=t.split("&"),n=0;n<a.length;n++)""!=a[n]&&e.push(a[n]);return e}(),u=.5,g=5,p=0,k=0,m=!1;return i.unique_id=r.unique_id,i.app_token=r.app_token,i.environment=r.environment,i.os_name=(s=e.navigator.platform,c=e.navigator.userAgent,o="MacIntel"===s||"MacPPC"===s?"mac-os":"CrOS"===s?"chrome-os":"Win32"===s||"Win64"==s?"windows":!o&&/Android/.test(c)?"android":!o&&/Linux/.test(s)?"linux":!o&&/Windows/.test(c)?"windows":"unknown"),i.app_version="1.0.0","sandbox"==i.environment&&console.log("Adtrace environment is running on sandbox. Please change it to `production` in release mode."),r.hasOwnProperty("default_tracker")&&(i.default_tracker=r.default_tracker),"android"==i.os_name?(i.gps_adid=i.unique_id,i.android_uuid=i.unique_id):"ios"==i.os_name?(i.idfa=i.unique_id,i.idfv=i.unique_id):i.win_adid=i.unique_id,i.unique_id!=d&&null!=l&&(localStorage.removeItem("adtrace_js_sdk_id"),localStorage.setItem("adtrace_js_sdk_packages",""),l=null),function e(){null==l?(r=function(t){var a=JSON.parse(t.responseText);a.hasOwnProperty("adid")?(l=a.adid,d=i.unique_id,localStorage.setItem("adtrace_js_sdk_id",l),localStorage.setItem("adtrace_js_sdk_unique_id",d),g=5,v(),console.log("Adtrace SDk initialized successfully")):(console.log("Adtrace SDK click will retry again in "+u*Math.pow(2,p)+" Sec."),console.log((new Date).getTime()),setTimeout(e,u*Math.pow(2,p)*1e3),p+=1)},o=function(t,a){console.log(t),console.log("Adtrace SDK click will retry again in "+u*Math.pow(2,p)+" Sec."),console.log((new Date).getTime()),setTimeout(e,u*Math.pow(2,p)*1e3),p+=1},(s=n(i)).device_type="phone",s.source="install_referrer",s.referrer="utm_source=google-play&utm_medium=organic",s.needs_response_details=1,s.event_buffering_enabled=0,s.raw_referrer=s.referrer,s.tracking_enabled=1,s.installed_at=(new Date).toISOString()+"+0000",s.session_count=1,s.attribution_deeplink=1,s.created_at=s.installed_at,s.sent_at=s.installed_at,t("POST","https://app.adtrace.io/sdk_click",a(s),r,o)):v();var r,o,s}(),{getAdId:function(){return l},trackSession:function(e,t){var r=n(i);r.created_at=(new Date).toISOString()+"+0000",r.sent_at=r.created_at,localStorage.setItem("adtrace_js_sdk_package_"+r.sent_at,"https://app.adtrace.io/session?"+a(r)),_.push(r.sent_at),localStorage.setItem("adtrace_js_sdk_packages",localStorage.getItem("adtrace_js_sdk_packages")+"&"+r.sent_at),v(e,t)},trackEvent:function(e,t,r){e=e||{};var o=n(i),s=function(e){var t=parseFloat(e.revenue);if(t<0||!e.currency)return null;return{revenue:t.toFixed(5),currency:e.currency}}(e),c=e.event_value,l=f(e.callback_params),d=f(e.partner_params);o.event_token=e.event_token,s&&(o.revenue=s.revenue,o.currency=s.currency);c&&(o.event_value=c);l&&(o.callback_params=JSON.stringify(l));d&&(o.partner_params=JSON.stringify(d));o.created_at=(new Date).toISOString()+"+0000",o.sent_at=o.created_at,localStorage.setItem("adtrace_js_sdk_package_"+o.sent_at,"https://app.adtrace.io/event?"+a(o)),_.push(o.sent_at),localStorage.setItem("adtrace_js_sdk_packages",localStorage.getItem("adtrace_js_sdk_packages")+"&"+o.sent_at),v(t,r)},stableLocalData:function(){l&&localStorage.setItem("adtrace_js_sdk_id",l);d&&localStorage.setItem("adtrace_js_sdk_unique_id",d)}};function f(e){if(!(e=e||[]).length)return null;for(var t={},a=0;a<e.length;a++)t[e[a].key]=e[a].value;return n(t)}function v(e,a){m||_.length>0&&""!=_[0]&&(m=!0,t("GET",localStorage.getItem("adtrace_js_sdk_package_"+_[0]),null,function(t){var a=_.slice();a.shift(),localStorage.removeItem("adtrace_js_sdk_package_"+_[0]);for(var n="",r=0;r<a.length;r++)n+=a[r],r+1!=a.length&&(n+="&");localStorage.setItem("adtrace_js_sdk_packages",n),m=!1,g=5,(_=a).length>0&&v(),e&&e(t)},function(e,t){console.log(e),console.log("Adtrace SDK package will retry again in "+g*Math.pow(2,k)+" Sec."),setTimeout(v,g*Math.pow(2,k)*1e3),k+=1,m=!1,a&&a(e,t)}))}}}(window);