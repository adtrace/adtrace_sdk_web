!function(e){"use strict";function t(e,t,a,n,r){var o=new XMLHttpRequest;o.open(e,t,!0),o.setRequestHeader("Client-SDK","js1.2.4"),"POST"==e&&o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.onreadystatechange=function(){4===o.readyState&&(o.status>=200&&o.status<400?n&&n(o):r&&r&&r(new Error("Server responded with HTTP "+o.status),o))},o.send(a)}function a(e){var t=[];for(var a in e)e.hasOwnProperty(a)&&t.push(encodeURIComponent(a)+"="+encodeURIComponent(e[a]));return t.join("&")}function n(e){var t={};if("object"!=typeof e||!e)return t;for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a]);return t}!1 in new XMLHttpRequest&&(t=function(){}),e.AdTrace=function(r){r=r||{};var o,s={},i=localStorage.getItem("adtrace_js_sdk_id"),c=localStorage.getItem("adtrace_js_sdk_unique_id"),d=function(){var e=[],t=localStorage.getItem("adtrace_js_sdk_packages");if(null==t)return localStorage.setItem("adtrace_js_sdk_packages",""),e;for(var a=t.split("&"),n=0;n<a.length;n++)""!=a[n]&&e.push(a[n]);return e}(),_=.5,l=5,u=0,g=0,p=!1;return s.unique_id=r.unique_id,s.app_token=r.app_token,s.environment=r.environment,s.os_name=(o=navigator.userAgent||navigator.vendor||e.opera,/android/i.test(o)?"android":/iPad|iPhone|iPod/.test(o)&&!e.MSStream?"ios":"android"),s.app_version="1.0.0","sandbox"==s.environment&&console.log("Adtrace environment is running on sandbox. Please change it to `production` in release mode."),r.hasOwnProperty("default_tracker")&&(s.default_tracker=r.default_tracker),"android"==s.os_name?(s.gps_adid=s.unique_id,s.android_uuid=s.unique_id):"ios"==s.os_name?(s.idfa=s.unique_id,s.idfv=s.unique_id):s.win_adid=s.unique_id,s.unique_id!=c&&null!=i&&(localStorage.removeItem("adtrace_js_sdk_id"),localStorage.setItem("adtrace_js_sdk_packages",""),i=null),function e(){null==i?(r=function(t){var a=JSON.parse(t.responseText);a.hasOwnProperty("adid")?(i=a.adid,c=s.unique_id,localStorage.setItem("adtrace_js_sdk_id",i),localStorage.setItem("adtrace_js_sdk_unique_id",c),l=5,f(),console.log("Adtrace SDk initialized successfully")):(console.log("Adtrace SDK click will retry again in "+_*Math.pow(2,u)+" Sec."),setTimeout(e,_*Math.pow(2,u)*1e3),u+=1)},o=function(t,a){console.log(t),console.log("Adtrace SDK click will retry again in "+_*Math.pow(2,u)+" Sec."),setTimeout(e,_*Math.pow(2,u)*1e3),u+=1},(d=n(s)).device_type="phone",d.source="install_referrer",d.referrer="utm_source=google-play&utm_medium=organic",d.needs_response_details=1,d.event_buffering_enabled=0,d.raw_referrer=d.referrer,d.tracking_enabled=1,d.installed_at=(new Date).toISOString()+"+0000",d.session_count=1,d.attribution_deeplink=1,d.created_at=d.installed_at,d.sent_at=d.installed_at,t("POST","https://app.adtrace.io/sdk_click",a(d),r,o)):f();var r,o,d}(),{getAdId:function(){return i},trackSession:function(e,t){var r=n(s);r.created_at=(new Date).toISOString()+"+0000",r.sent_at=r.created_at,localStorage.setItem("adtrace_js_sdk_package_"+r.sent_at,"https://app.adtrace.io/session?"+a(r)),d.push(r.sent_at),localStorage.setItem("adtrace_js_sdk_packages",localStorage.getItem("adtrace_js_sdk_packages")+"&"+r.sent_at),f(e,t)},trackEvent:function(e,t,r){e=e||{};var o=n(s),i=function(e){var t=parseFloat(e.revenue);if(t<0||!e.currency)return null;return{revenue:t.toFixed(5),currency:e.currency}}(e),c=e.event_value,_=k(e.callback_params),l=k(e.partner_params);o.event_token=e.event_token,i&&(o.revenue=i.revenue,o.currency=i.currency);c&&(o.event_value=c);_&&(o.callback_params=JSON.stringify(_));l&&(o.partner_params=JSON.stringify(l));o.created_at=(new Date).toISOString()+"+0000",o.sent_at=o.created_at,localStorage.setItem("adtrace_js_sdk_package_"+o.sent_at,"https://app.adtrace.io/event?"+a(o)),d.push(o.sent_at),localStorage.setItem("adtrace_js_sdk_packages",localStorage.getItem("adtrace_js_sdk_packages")+"&"+o.sent_at),f(t,r)},stableLocalData:function(){i&&localStorage.setItem("adtrace_js_sdk_id",i);c&&localStorage.setItem("adtrace_js_sdk_unique_id",c)}};function k(e){if(!(e=e||[]).length)return null;for(var t={},a=0;a<e.length;a++)t[e[a].key]=e[a].value;return n(t)}function f(e,a){p||d.length>0&&""!=d[0]&&(p=!0,t("GET",localStorage.getItem("adtrace_js_sdk_package_"+d[0]),null,function(t){var a=d.slice();a.shift(),localStorage.removeItem("adtrace_js_sdk_package_"+d[0]);for(var n="",r=0;r<a.length;r++)n+=a[r],r+1!=a.length&&(n+="&");localStorage.setItem("adtrace_js_sdk_packages",n),p=!1,l=5,(d=a).length>0&&f(),e&&e(t)},function(e,t){console.log(e),console.log("Adtrace SDK package will retry again in "+l*Math.pow(2,g)+" Sec."),setTimeout(f,l*Math.pow(2,g)*1e3),g+=1,p=!1,a&&a(e,t)}))}}}(window);